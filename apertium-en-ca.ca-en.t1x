<?xml version="1.0" encoding="UTF-8"?> <!-- -*- nxml -*- -->
<transfer default="chunk">
<!--
*********************************************************************************************
                           PRONOMS FEBLES

La traducció i enxuncació dels pronoms febles (enclítics i proclítics)
del català a l'anglès és una mica complicada. Consideracions prèvies:

-hi ha pronoms que es tradueixen per res (en/hi)
-hi ha el pronom reflexiu (es), que també es tradueix per res

El que es fa en el t1x, a grans trets, és

-es mira si el verb és pronominal i el pronom concorda en pers i nbr
amb el verb, en aquest cas no s'envia cap pronom.
-si no es compleix el punt anterior: quan el pronom es tradueix per res (en/hi) o és el pronom reflexiu (es):
        -pronoms enclítics: no s'envia res, perquè el pronom entra en el mateix xunc que
	el verb (treballar-hi, treballar-se). 
        -pronoms proclítics: degut a la construcció de la regla, el pronom s'envia en un xunc individual, en què:
                  -si és pronom 'en' o 'hi', s'envia com a SN però de contingut buit.
		  -si el pronom és 'es', s'envia com a xunc de lema ref i etiqueta ref, de contingut buit, 
                   per si cal fer alguna cosa en el t2x (passives reflexives, etc.), cosa que per ara, a nov. 2008, 
                   no es fa.
           Excepció: els pronoms proclítics no s'envien en un xunc individual en cas que el verb sigui separable (take it out)

El fet que un pronom de traducció 'buida' no s'enviï si és enclític o està amb un verb separable
i sí que s'enviï si és proclític i no està amb verb separable, és degut al disseny
del transfer i les regles. Potser seria necessari redefinir les regles.

*********************************************************************************************
-->

  <section-def-cats>
    <def-cat n="nom">
      <cat-item tags="n.*"/><!--Falten els altres np (antroponims) que tenen gen i nbr, revisar regles.-->
      <cat-item tags="np.loc.*"/>
    </def-cat>

     <def-cat n="ant">
      <cat-item tags="np.ant.*"/>
    </def-cat>
     <def-cat n="loc">
      <cat-item tags="np.loc.*"/>
    </def-cat>
     <def-cat n="al">
      <cat-item tags="np.al.*"/>
    </def-cat>
     <def-cat n="cog">
      <cat-item tags="np.cog.*"/>
    </def-cat>

    <def-cat n="adj">
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.pos.*"/>
      <cat-item tags="adjant.*"/>
    </def-cat>
    <def-cat n="adj_pp">
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.pos.*"/>
      <cat-item tags="adjant.*"/>
      <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="det"><!--Determinants i predeterminants, van anteposats en català -->
      <cat-item tags="det.dem.*"/>
      <cat-item tags="det.ind.*"/>
      <cat-item tags="det.def.*"/>
      <cat-item tags="det.pos.*"/>
      <cat-item tags="det.qnt.*"/>
      <cat-item tags="det.itg.*"/>
      <cat-item tags="det.ord.*"/>
      <cat-item tags="predet.*"/>
      <!-- <cat-item tags="num.*"/> -->
    </def-cat>

    <def-cat n="detdef">
      <cat-item tags="det.def.*"/>
    </def-cat>

    <def-cat n="el"><!--afegir-hi tb 'un'? (un 30%). No sé si tb desapareix -->
      <cat-item lemma="el" tags="det.def.m.sg"/>
    </def-cat>

    <def-cat n="num">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
    </def-cat>

    <def-cat n="digits">
      <cat-item lemma="1" tags="num"/>
      <cat-item lemma="2" tags="num"/>
      <cat-item lemma="3" tags="num"/>
      <cat-item lemma="4" tags="num"/>
      <cat-item lemma="5" tags="num"/>
      <cat-item lemma="6" tags="num"/>
      <cat-item lemma="7" tags="num"/>
      <cat-item lemma="8" tags="num"/>
      <cat-item lemma="9" tags="num"/>
      <cat-item lemma="10" tags="num"/>
      <cat-item lemma="11" tags="num"/>
      <cat-item lemma="12" tags="num"/>
      <cat-item lemma="13" tags="num"/>
      <cat-item lemma="14" tags="num"/>
      <cat-item lemma="15" tags="num"/>
      <cat-item lemma="16" tags="num"/>
      <cat-item lemma="17" tags="num"/>
      <cat-item lemma="18" tags="num"/>
      <cat-item lemma="19" tags="num"/>
      <cat-item lemma="20" tags="num"/>
      <cat-item lemma="21" tags="num"/>
      <cat-item lemma="22" tags="num"/>
      <cat-item lemma="23" tags="num"/>
      <cat-item lemma="24" tags="num"/>
      <cat-item lemma="25" tags="num"/>
      <cat-item lemma="26" tags="num"/>
      <cat-item lemma="27" tags="num"/>
      <cat-item lemma="28" tags="num"/>
      <cat-item lemma="29" tags="num"/>
      <cat-item lemma="30" tags="num"/>
      <cat-item lemma="31" tags="num"/>
    </def-cat>

    <def-cat n="percent">
      <cat-item tags="num.percent"/>
    </def-cat>

    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="a">
      <cat-item lemma="a" tags="pr"/>
    </def-cat>
    <def-cat n="fins">
      <cat-item lemma="fins" tags="pr"/>
    </def-cat>
    <def-cat n="aquí">
      <cat-item lemma="aquí" tags="adv"/>
    </def-cat>


    <def-cat n="prpers">
      <cat-item lemma="prpers" tags="prn.*"/>
    </def-cat>

    <def-cat n="tn_itg_pos"><!--Aquí no hi entren els pronoms personals, caldrà fer-ne un xunc a part. -->
      <cat-item tags="prn.tn.m.*"/>
      <cat-item tags="prn.tn.f.*"/>
      <cat-item tags="prn.tn.mf.*"/>
      <cat-item tags="prn.itg.*"/>
      <cat-item tags="prn.pos.*"/>
    </def-cat>
    
    <def-cat n="enc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>

    <def-cat n="pro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>

    <def-cat n="verbnm_inf_ger"><!--verb no modal, infinitiu i gerundi -->
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.pron.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbser.pron.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbhaver.pron.inf"/>
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vblex.pron.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbser.pron.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbhaver.pron.ger"/>
    </def-cat>

    <def-cat n="verbnm_imp"><!--verb no modal, imperatiu -->
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.pron.imp.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbser.pron.imp.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbhaver.pron.imp.*"/>
    </def-cat>

    <def-cat n="verbm"><!--verb modal -->
      <cat-item tags="vbmod.*"/>
    </def-cat>

    <def-cat n="verbm_inf_ger"><!--verb modal, infinitiu o gerundi -->
      <cat-item tags="vbmod.inf"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>

    <def-cat n="haver">
      <cat-item tags="vbhaver.*"/>
    </def-cat>
    <def-cat n="haverinf">
      <cat-item tags="vbhaver.inf"/>
    </def-cat>

    <def-cat n="caldre">
      <cat-item lemma="caldre" tags="vbmod.*"/>
    </def-cat>


  <def-cat n="estar">
      <cat-item lemma="estar" tags="vblex.cni.*"/>
      <cat-item lemma="estar" tags="vblex.fti.*"/>
      <cat-item lemma="estar" tags="vblex.ifi.*"/>
      <cat-item lemma="estar" tags="vblex.imp.*"/>
      <cat-item lemma="estar" tags="vblex.pii.*"/>
      <cat-item lemma="estar" tags="vblex.pis.*"/>
      <cat-item lemma="estar" tags="vblex.pri.*"/>
      <cat-item lemma="estar" tags="vblex.prs.*"/>
  </def-cat>

    <def-cat n="verbcj">
      <cat-item tags="vblex.cni.*"/>
      <cat-item tags="vblex.fti.*"/>
      <cat-item tags="vblex.ifi.*"/>
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.pis.*"/>
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.prs.*"/>
      <cat-item tags="vbser.cni.*"/>
      <cat-item tags="vbser.fti.*"/>
      <cat-item tags="vbser.ifi.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbser.pii.*"/>
      <cat-item tags="vbser.pis.*"/>
      <cat-item tags="vbser.pri.*"/>
      <cat-item tags="vbser.prs.*"/>
      <cat-item tags="vbhaver.cni.*"/>
      <cat-item tags="vbhaver.fti.*"/>
      <cat-item tags="vbhaver.ifi.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbhaver.pii.*"/>
      <cat-item tags="vbhaver.pis.*"/>
      <cat-item tags="vbhaver.pri.*"/>
      <cat-item tags="vbhaver.prs.*"/>
      <cat-item tags="vbmod.cni.*"/>
      <cat-item tags="vbmod.fti.*"/>
      <cat-item tags="vbmod.ifi.*"/>
      <cat-item tags="vbmod.imp.*"/>
      <cat-item tags="vbmod.pii.*"/>
      <cat-item tags="vbmod.pis.*"/>
      <cat-item tags="vbmod.pri.*"/>
      <cat-item tags="vbmod.prs.*"/>
      <cat-item tags="vblex.pron.cni.*"/>
      <cat-item tags="vblex.pron.fti.*"/>
      <cat-item tags="vblex.pron.ifi.*"/>
      <cat-item tags="vblex.pron.imp.*"/>
      <cat-item tags="vblex.pron.pii.*"/>
      <cat-item tags="vblex.pron.pis.*"/>
      <cat-item tags="vblex.pron.pri.*"/>
      <cat-item tags="vblex.pron.prs.*"/>
    </def-cat>

    <def-cat n="pp">
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vblex.pron.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/><!--ATENCIÓ: CANVI -->
    </def-cat>

    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.pron.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
<!--      <cat-item tags="vbmod.inf"/>-->
    </def-cat>
    <def-cat n="mod_inf">
      <cat-item tags="vbmod.inf"/>
    </def-cat>

    <def-cat n="fa">
      <cat-item lemma="fer" tags="vblex.pri.p3.sg"/>
    </def-cat>

    <def-cat n="ger">
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vblex.pron.ger"/>
      <cat-item tags="vbser.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbmod.ger"/>
    </def-cat>


    <def-cat n="mesos">
      <cat-item lemma="gener" tags="n.*"/>
      <cat-item lemma="febrer" tags="n.*"/>
      <cat-item lemma="març" tags="n.*"/>
      <cat-item lemma="abril" tags="n.*"/>
      <cat-item lemma="maig" tags="n.*"/>
      <cat-item lemma="juny" tags="n.*"/>
      <cat-item lemma="juliol" tags="n.*"/>
      <cat-item lemma="august" tags="n.*"/>
      <cat-item lemma="setembre" tags="n.*"/>
      <cat-item lemma="octubre" tags="n.*"/>
      <cat-item lemma="novembre" tags="n.*"/>
      <cat-item lemma="desembre" tags="n.*"/>
    </def-cat>

    <def-cat n="anar">
      <cat-item lemma="anar" tags="vblex.pri.*"/>
    </def-cat>

    <def-cat n="adv_preadv">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="preadv">
      <cat-item tags="preadv"/>
    </def-cat>

    <def-cat n="més">
      <cat-item lemma="més" tags="adv"/>
      <cat-item lemma="més" tags="preadv"/>
      <cat-item lemma="més" tags="det.*"/>
    </def-cat>

    <def-cat n="adv">
      <cat-item tags="adv"/>
    </def-cat>

    <def-cat n="advitg">
      <cat-item tags="adv.itg"/>
    </def-cat>

    <def-cat n="no">
      <cat-item lemma="no" tags="adv"/>
    </def-cat>

    <def-cat n="cnjcoo">
      <cat-item lemma="i" tags="cnjcoo"/>
      <cat-item lemma="o" tags="cnjcoo"/>
      <cat-item lemma="però" tags="cnjcoo"/>
    </def-cat>

     <def-cat n="cnj">
      <cat-item tags="cnjcoo"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="cnjadv"/>
    </def-cat>

    <def-cat n="per">
      <cat-item lemma="per" tags="pr"/>
    </def-cat>

    <def-cat n="per_pera">
      <cat-item lemma="per" tags="pr"/>
      <cat-item lemma="per a" tags="pr"/>
    </def-cat>

    <def-cat n="de">
      <cat-item lemma="de" tags="pr"/>
    </def-cat>

    <def-cat n="rel">
      <cat-item tags="rel.*"/>
    </def-cat>

    <def-cat n="tot">
      <cat-item lemma="tot" tags="predet.*"/>
      <cat-item lemma="tot" tags="prn.tn.m.sg"/>
    </def-cat>

    <def-cat n="i">
      <cat-item lemma="i" tags="cnjcoo"/>
    </def-cat>

    <def-cat n="periode">
      <cat-item lemma="minut" tags="n.*"/>
      <cat-item lemma="hora" tags="n.*"/>
      <cat-item lemma="dia" tags="n.*"/>
      <cat-item lemma="setmana" tags="n.*"/>
      <cat-item lemma="quinzena" tags="n.*"/>
      <cat-item lemma="mes" tags="n.*"/>
      <cat-item lemma="any" tags="n.*"/>
      <cat-item lemma="dècada" tags="n.*"/>
      <cat-item lemma="segle" tags="n.*"/>
    </def-cat>

    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>

  <def-cat n="coma">
      <cat-item tags="cm"/>
    </def-cat>

  </section-def-cats>
  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
      <attr-item tags="np.loc"/>
      <attr-item tags="np.ant"/>
      <attr-item tags="np.al"/>	
      <attr-item tags="np.cog"/>
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="a_np_acr">
      <attr-item tags="np"/>
      <attr-item tags="acr"/>
    </def-attr>

    <def-attr n="a_adj">          
      <attr-item tags="adj"/> 
      <attr-item tags="adj.sint"/>
      <attr-item tags="adj.sint.comp"/>
      <attr-item tags="adj.sint.sup"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="vblex.pp"/>   
      <attr-item tags="adjant"/>
    </def-attr>  

    <def-attr n="grau">      
      <attr-item tags="sup"/> 
    </def-attr>

    <def-attr n="a_prep">      
      <attr-item tags="pr"/> 
    </def-attr>

    <def-attr n="a_det">
      <attr-item tags="det.dem"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.def"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="det.qnt"/>
      <attr-item tags="det.itg"/>
      <attr-item tags="det.ord"/>
      <attr-item tags="predet"/>
      <attr-item tags="num"/>
    </def-attr>

    <def-attr n="a_num">
      <attr-item tags="num"/>
      <attr-item tags="num.ord"/>
      <attr-item tags="num.percent"/>
      <attr-item tags="num.mon"/>
    </def-attr>

    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
      <attr-item tags="vaux"/>
    </def-attr>

    <def-attr n="pron">
      <attr-item tags="pron"/>
    </def-attr>

    <def-attr n="sep">
      <attr-item tags="sep"/>
    </def-attr>

    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
      <attr-item tags="adv.itg"/>
    </def-attr>

    <def-attr n="a_rel">
      <attr-item tags="rel.nn"/>
      <attr-item tags="rel.an"/>
      <attr-item tags="rel.adv"/>
    </def-attr>

    <def-attr n="a_pp">
      <attr-item tags="vblex.pp"/>
      <attr-item tags="vbser.pp"/>
      <attr-item tags="vbmod.pp"/>
      <attr-item tags="vblex.sep.pp"/>
      <attr-item tags="vbser.sep.pp"/>
      <attr-item tags="vbmod.sep.pp"/>
      <attr-item tags="vaux.pp"/>
      <attr-item tags="vbhaver.pp"/>
    </def-attr>

    <def-attr n="a_prn">
      <attr-item tags="prn"/>
    </def-attr>

    <def-attr n="tipus_prn">
      <attr-item tags="subj"/>
      <attr-item tags="obj"/>
      <attr-item tags="tn"/>
      <attr-item tags="itg"/>
      <attr-item tags="pos"/>
    </def-attr>
    <def-attr n="pers">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>

    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="nt"/>
    </def-attr>

    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>

    <def-attr n="temps">
      <attr-item tags="cni"/>
      <attr-item tags="fti"/>  
      <attr-item tags="ifi"/>
      <attr-item tags="imp"/>
      <attr-item tags="pii"/>
      <attr-item tags="pis"/>
      <attr-item tags="pri"/>
      <attr-item tags="prs"/>
      <attr-item tags="pres"/>
      <attr-item tags="past"/>
      <attr-item tags="pp"/>
      <attr-item tags="pprs"/>
      <attr-item tags="subs"/>
      <attr-item tags="ger"/>
      <attr-item tags="inf"/>
    </def-attr>



    <def-attr n="neg">
      <attr-item tags="NEG"/>
    </def-attr>  

  </section-def-attrs>
  <section-def-vars>
    <def-var n="nombre" v="&amp;lt;sg&amp;gt;"/>
    <def-var n="genere" v="&amp;lt;m&amp;gt;"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
    <def-var n="caseFirstWord"/> 
    <def-var n="caseSecondWord"/>
    <def-var n="lema"/>
    <def-var n="lema_SV"/>
    <def-var n="lema_chunk"/>
    <def-var n="EOS" v="true"/>
    <def-var n="paraula1"/>
    <def-var n="SVnegatiu"/>
    <def-var n="auxiliar"/>
    <def-var n="adv_adjectiu"/>
    <def-var n="tempsv"/>
    <def-var n="temps_chunk"/>
    <def-var n="pers_chunk"/>
    <def-var n="nbr_chunk"/>
    <def-var n="gen_chunk"/>
    <def-var n="nom_chunk"/>
    <def-var n="tipusnom_chunk"/>
    <def-var n="verbfinal"/>
    <def-var n="tipusverb"/>
    <def-var n="lemaverb"/>
    <def-var n="superlatiu1"/>
    <def-var n="superlatiu2"/>
  </section-def-vars>

  <section-def-lists>

    <def-list n="det_canviant">
      <list-item v="un"/>
      <list-item v="un altre"/>
      <list-item v="poc"/>
      <list-item v="quant"/>
      <list-item v="menys"/>
      <list-item v="gaire"/>
      <list-item v="tant"/>
      <list-item v="massa"/>
    </def-list>



 <def-list n="preps_inf">
      <list-item v="so as to"/>
      <list-item v="with a view to"/>
      <list-item v="to"/>
      <list-item v="in order to"/>
    </def-list>

 <def-list n="en_majuscules">
      <list-item v="Monday"/>
      <list-item v="Tuesday"/>
      <list-item v="Wednesday"/>
      <list-item v="Thursday"/>
      <list-item v="Friday"/>
      <list-item v="Saturday"/>
      <list-item v="Sunday"/>
 </def-list>

   <def-list n="verbs_moviment">
      <list-item v="anar"/>
      <list-item v="traslladar"/>
      <list-item v="viatjar"/>
      <list-item v="emigrar"/>
      <list-item v="inmigrar"/>
      <list-item v="moure"/>
      <list-item v="venir"/>
      <list-item v="vindre"/>
      <list-item v="eixir"/>
      <list-item v="sortir"/>
      <list-item v="entrar"/>
      <list-item v="pujar"/>
      <list-item v="baixar"/>
      <list-item v="caminar"/>
      <list-item v="dirigir"/>
      <list-item v="apropar"/>
      <list-item v="córrer"/>
      <list-item v="portar"/>
      <list-item v="passar"/>
      <list-item v="tornar"/>
      <list-item v="regressar"/>
      <list-item v="arribar"/>
      <list-item v="marxar"/>
    </def-list>
    
    <def-list n="np_article"><!--poden portat article en  català i no en porten en anglès -->
      <list-item v="Afganistan"/>
      <list-item v="Iraq"/>
      <list-item v="Zaire"/>
      <list-item v="Kurdistan"/>
      <list-item v="Sudan"/>
    </def-list>

    <def-list n="titols">
      <list-item v="ministre"/>
      <list-item v="president"/>
      <list-item v="primer ministre"/>
      <list-item v="rei"/>
      <list-item v="príncep"/>
      <list-item v="duc"/>
    </def-list>
    <def-list n="geografia">
      <list-item v="costa"/>
      <list-item v="mar"/>
      <list-item v="universitari"/>
      <list-item v="universitat"/>
    </def-list>
    <def-list n="direccio">
      <list-item v="nord"/>
      <list-item v="sud"/>
      <list-item v="est"/>
      <list-item v="oest"/>
      <list-item v="nord-est"/>
      <list-item v="nord-oest"/>
      <list-item v="sud-est"/>
      <list-item v="sud-oest"/>
    </def-list>
    <def-list n="familia">
      <list-item v="fill"/>
      <list-item v="mare"/>
      <list-item v="pare"/>
      <list-item v="cosí"/>
      <list-item v="gendre"/>
      <list-item v="germà"/>
      <list-item v="avi"/>
      <list-item v="nét"/>
      <list-item v="tia"/>
      <list-item v="oncle"/>
    </def-list>
  </section-def-lists>


  <section-def-macros>
    

    <def-macro n="f_bcond" npar="2"><!--Per mirar si el blanc conté o no format. Cal posar aquesta funció en les regles en què desaparegui alguna paraula, per tal de decidir si el blanc de la paraula eliminada s'ha d'eliminar o conservar. Si conté format cal conservar-la, si no en conté cal eliminar-la perquè no apareguin dos espais seguits. -->
      <choose>
	<when>
	  <test>
	    <not>
	      <equal>
		<b pos="1"/>
		<lit v=" "/>
	      </equal>
	    </not>
	  </test>
	  <out>
	    <b pos="1"/>
	  </out>
	</when>     	    
      </choose>
    </def-macro>


    <def-macro n="nombre_nom" npar="1"><!-- per determinar si hi ha hagut canvi de nombre en la traducció. Després d'aquesta macro s'aplica la macro 'canvia_det'. Caldria ajuntar aquesta macro i la 'canvia_det' !!!!!!! -->
      <let>
	<var n="nombre"/>
	<lit v=""/>
      </let>
      <choose>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="sl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="nombre"/>
	    <lit-tag v="pl_slsg"/>
	  </let>
	</when>
	<when>
	  <test>
	    <and>
	      <equal>
		<clip pos="1" side="sl" part="nbr"/>
		<lit-tag v="pl"/>
	      </equal>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	    </and>
	  </test>
	  <let>
	    <var n="nombre"/>
	    <lit-tag v="sg_slpl"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="nombre"/>
	    <clip pos="1" side="tl" part="nbr"/>
	  </let>
	</otherwise>
      </choose> 
    </def-macro>

   
 <def-macro n="tipus_nom" npar="1">
      <choose>
	<when>
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lem"/>
	      <list n="titols"/>
	    </in>
	  </test>
          <let>
            <var n="tipusnom_chunk"/>
            <lit v="titol"/>
          </let>
	</when>
	<when>
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lem"/>
	      <list n="geografia"/>
	    </in>
	  </test>
          <let>
            <var n="tipusnom_chunk"/>
            <lit v="geog"/>
          </let>
	</when>
	<when>
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lem"/>
	      <list n="direccio"/>
	    </in>
	  </test>
          <let>
            <var n="tipusnom_chunk"/>
            <lit v="direccio"/>
          </let>
	</when>
	<when>
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lem"/>
	      <list n="familia"/>
	    </in>
	  </test>
          <let>
            <var n="tipusnom_chunk"/>
            <lit v="fam"/>
          </let>
	</when>
        <otherwise>
          <let>
            <var n="tipusnom_chunk"/>
            <lit v="nom"/>
          </let>
        </otherwise>
      </choose>
</def-macro>




    <def-macro n="canvia_det" npar="2">
      <choose>
	<when>
	  <test>
	    <in caseless="yes">
	      <clip pos="1" side="sl" part="lem"/>
	      <list n="det_canviant"/>
	    </in>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <var n="nombre"/>
		    <lit-tag v="sg_slpl"/>
		  </equal>
		  <and><!--perquè no doni error en casos (errors original) com 'uns arbre' -->
		    <equal>
		      <clip pos="2" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		  </and>
		</or>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="some"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="a"/>
		    </get-case-from>
		  </let>
		  <let>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.ind"/>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="other"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="another"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="few"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="little"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="how many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="how much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="fewer"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="less"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="so many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="so much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="too many"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too much"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>

	    <when>
	      <test>
		<or>
		  <equal>
		    <var n="nombre"/>
		    <lit-tag v="pl_slsg"/>
		  </equal>
		  <and><!--perquè no doni error en casos com 'un Cases' -->
		    <equal>
		      <clip pos="2" side="sl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </and>
		</or>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="a"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="some"/>
		    </get-case-from>
		  </let>
		  <let>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.qnt"/>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="another"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="other"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="little"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="few"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="how much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="how many"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="less"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="fewer"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="many"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="so much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="so many"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal caseless="yes">
		      <clip pos="1" side="tl" part="lem"/>
		      <lit v="too much"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too many"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>

	    <when>
	      <test>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="menys"/>
		</equal>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="less"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="fewer"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>
	    <when>
	      <test>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="massa"/>
		</equal>
	      </test>
	      <choose>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too much"/>
		    </get-case-from>
		  </let>
		</when>
		<when>
		  <test>
		    <equal>
		      <clip pos="2" side="tl" part="nbr"/>
		      <lit-tag v="pl"/>
		    </equal>
		  </test>
		  <let>
		    <clip pos="1" side="tl" part="lem"/>
		    <get-case-from pos="1">
		      <lit v="too many"/>
		    </get-case-from>
		  </let>
		</when>
	      </choose>
	    </when>
	  </choose>
	</when>

      </choose>
    </def-macro>

 <def-macro n="f_concord2" npar="2"><!--element 1= principal (nom). Element 2 = secundari (adj/det) 
				    En anglès els noms poden ser sg, pl o ND (mai sp en els diccs actuals)-->
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="2" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>	

	  </choose>
	</when>
      </choose>
</def-macro>
		
	


<def-macro n="f_concord3" npar="3"><!--element 1= principal (nom). Element 2 i 3 = secundari (adj/det) 
				    En anglès els noms poden ser sg, pl o ND (mai sp en els diccs actuals)-->
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="2" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="3" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="3" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
</def-macro>


<def-macro n="f_concord4" npar="4"><!--element 1= principal (nom). Element 2 i 3 = secundari (adj/det) 
				    En anglès els noms poden ser sg, pl o ND (mai sp en els diccs actuals)-->
      <choose>
	<when>
	  <test>
	    <equal>
	      <clip pos="1" side="tl" part="nbr"/>
	      <lit-tag v="ND"/>
	    </equal>
	  </test>
	  <choose>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="2" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="2" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="3" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="3" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="3" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	    
	    <when>
	      <test>
		<or>
		  <equal>
		    <clip pos="4" side="tl" part="nbr"/>
		    <lit-tag v="sg"/>
		  </equal>
		  <equal>
		    <clip pos="4" side="tl" part="nbr"/>
		    <lit-tag v="pl"/>
		  </equal>
		</or>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<clip pos="4" side="tl" part="nbr"/>
	      </let>
	    </when>
	    <when><!--'tres dijous' -->
	      <test>
		<equal>
		  <clip pos="4" side="tl" part="a_num"/>
		  <lit-tag v="num"/>
		</equal>
	      </test>
	      <let>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="pl"/>
	      </let>
	    </when>
	  </choose>
	</when>
      </choose>
</def-macro>
		  

<def-macro n="donar_per" npar="1">
  <choose>
    <when>
      <test>
	<equal>
	  <clip pos="1" side="sl" part="lem"/>
	  <lit v="donar# per"/>
	</equal>
      </test>
      <choose>
        <when>
          <test>
	    <equal>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </equal>
          </test>
          <let>
            <var n="lema_SV"/>
	    <lit v="donar_per"/>
          </let>
        </when>
        <when>
          <test>
	    <equal>
	      <var n="lema_SV"/>
	      <lit v="aux_verb"/>
	    </equal>
          </test>
          <let>
            <var n="lema_SV"/>
	    <lit v="aux_donar_per"/>
          </let>
        </when>
      </choose>
    </when>
  </choose>

 <choose>
    <when>
      <test>
	<equal caseless="yes">
	  <clip pos="1" side="sl" part="lem"/>
	  <lit v="tenir"/>
	</equal>
        </test>
        <let>
            <var n="lema_SV"/>
	    <lit v="tohavevblex"/>
        </let>
    </when>
</choose>
</def-macro>



<def-macro n="elimina_ND" npar="1">
  <choose>
    <when>
      <test>
	<equal>
	  <clip pos="1" side="tl" part="nbr"/>
	  <lit-tag v="ND"/>
	</equal>
      </test>
      <let>
	<clip pos="1" side="tl" part="nbr"/>
	<lit-tag v="sg"/>
      </let>
    </when>
  </choose>
</def-macro>
	
	  


  <def-macro n="firstWord" npar="1"><!--nova versió 8-febr-08  -->
      
	  <choose>
	    <when>
	      <test>
		<equal> 
		  <var n="EOS"/>
		  <lit v="true"/>
		</equal> 
	      </test>
	      <choose>
		<when>
		  <test>
		    <and>
		      <equal>
			<clip pos="1" side="sl" part="a_np_acr"/>
			<lit v=""/>
		      </equal>
		      <not>
			<in>
			  <clip pos="1" side="tl" part="lem"/>
			  <list n="en_majuscules"/>
			</in>
		      </not>
		    </and>
		  </test>
		  <modify-case>
		    <clip pos="1" side="tl" part="lem"/>
		    <lit v="aa"/>
		  </modify-case>
		</when>
	      </choose>
	      <let>
		<var n="caseFirstWord"/>
		<lit v="Aa"/>
	      </let>
	    </when>
	    <otherwise> 
	      <let>
		<var n="caseFirstWord"/>
		<lit v="aa"/>
	      </let>
	    </otherwise>
	  </choose>
<!--	</when>
	<otherwise>
	  <let>
	    <var n="caseFirstWord"/>
	    <lit v="aa"/>
	  </let>
	</otherwise>
      </choose>-->
      <let>
	<var n="EOS"/>
	<lit v="false"/>
      </let>
    </def-macro>



<def-macro n="prep_inf" npar="2">
      <choose>
	<when>
	  <test>
	    <or>
	      <equal caseless="yes">	      
		<clip pos="1" side="sl" part="lem"/>
		<lit v="per"/>
	      </equal>
	      <equal caseless="yes">	      
		<clip pos="1" side="sl" part="lem"/>
		<lit v="per a"/>
	      </equal>
	      <equal caseless="yes">	      
		<clip pos="1" side="sl" part="lem"/>
		<lit v="de"/>
	      </equal>	      
	    </or>
	  </test>
	  <let>
	    <clip pos="1" side="tl" part="lem"/>
	      <get-case-from pos="1">
		<lit v="to"/>
	      </get-case-from>
	  </let>
	</when>
      </choose>
      <choose>	    
	<when>
	  <test>
	    <equal caseless="yes">
	      <clip pos="2" side="sl" part="lem"/> 
	      <lit v="poder"/>
	    </equal>
	  </test>
	  <let>		     
	    <clip pos="2" side="tl" part="lem"/>
	    <get-case-from pos="2">
	      <lit v="be able to"/>
	    </get-case-from>
	  </let>
	  <let>		     
	    <clip pos="2" side="tl" part="a_verb"/>
	    <lit-tag v="vbmod"/>
	  </let>
	</when>
      </choose>
      <choose>
	<when>
	  <test>
	    <not>
	      <in caseless="yes">
		<clip pos="1" side="tl" part="lem"/>
		<list n="preps_inf"/>
	      </in>
	    </not>
	  </test>
	  <let>	    
	    <clip pos="2" side="tl" part="temps"/>
	    <lit-tag v="ger"/>
	  </let>
	  <let>
	    <var n="tempsv"/>
	    <lit v="ger"/>
	  </let>
	</when>
	<otherwise>
	  <let>
	    <var n="tempsv"/>
	    <lit v="inf"/>
	  </let>
	</otherwise>
      </choose>
</def-macro>


<def-macro n="adv_adj" npar="2"><!-- (per a fer el comparatiu si cal: 'més fosc' = darker; i també per a canviar 'well' per 'very' davant adjectius )". En les regles, és obligatori que s'executi després de la macro 'f_superlatiu1' aplicada a l'adjectiu. -->
	<choose>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="més"/>
		</equal>
		<equal>
		  <clip pos="2" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		  <lit-tag v="comp"/>
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="molt més"/>
		</equal>
		<equal>
		  <clip pos="2" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <let>	      
	      <clip pos="1" side="tl" part="lem"/> 
	      <get-case-from pos="1">
	      <lit v="much"/>
	      </get-case-from>
	    </let>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="1" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <lit-tag v="comp"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>
		  <lit v="ben"/>
		</equal>
		<not>
		  <equal>
		    <clip pos="2" side="sl" part="a_adj"/>
		    <lit-tag v="vblex.pp"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <get-case-from pos="1">
		    <lit v="very"/>
		  </get-case-from>
		  <lit-tag v="preadv"/> 
		  <lit v="$ ^"/>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</concat>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="1" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <var n="superlatiu1"/>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</concat>
	    </let>
	  </otherwise>
	</choose>

	      
		
		
</def-macro>

<def-macro n="det_adv_adj" npar="3"><!-- (per a fer el comparatiu i superlatiu si cal: 'més fosc' = 'darker'; 'el més fosc' = 'the darkest')" . En les regles, és obligatori que s'executi després de la macro 'f_superlatiu1' aplicada a l'adjectiu. -->
	<choose>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/> 
		  <lit v="més"/>
		</equal>
		<equal>
		  <clip pos="3" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="sl" part="a_det"/>
		    <lit-tag v="det.def"/>
		  </equal>
		</test>		  
		<let>
		  <var n="adv_adjectiu"/>
		  <concat>
		    <clip pos="3" side="tl" part="lemh"/> 
		    <clip pos="3" side="tl" part="a_adj"/>
		    <lit-tag v="sup"/>
		    <clip pos="3" side="tl" part="lemq"/> 
		  </concat>
		</let>
	      </when>
	      <otherwise>	  
		<let>
		  <var n="adv_adjectiu"/>
		  <concat>
		    <clip pos="3" side="tl" part="lemh"/> 
		    <clip pos="3" side="tl" part="a_adj"/>
		    <lit-tag v="comp"/>
		    <clip pos="3" side="tl" part="lemq"/> 
		  </concat>
		</let>
	      </otherwise>
	    </choose>
	  </when>

	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/> 
		  <lit v="molt més"/>
		</equal>
		<equal>
		  <clip pos="3" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test>
	    <let>	      
	      <clip pos="2" side="tl" part="lem"/> 
	      <get-case-from pos="2">
		<lit v="much"/>
	      </get-case-from>
	    </let>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <lit-tag v="comp"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/> 
		  <lit v="més"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="a_det"/>
		  <lit-tag v="det.def"/>
		</equal>
	      </and>
	    </test>	
	    <let>  
	      <clip pos="2" side="tl" part="lem"/>
	      <get-case-from pos="2"> 
		<lit v="most"/>
	      </get-case-from>
	    </let>		    
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>
		  <lit v="ben"/>
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="a_adj"/>
		    <lit-tag v="vblex.pp"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <get-case-from pos="2">
		    <lit v="very"/>
		  </get-case-from>
		  <lit-tag v="preadv"/> 
		  <lit v="$ ^"/>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</concat>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="adv_adjectiu"/>
		<concat>
		  <clip pos="2" side="tl" part="whole"/> 
		  <lit v="$ ^"/>
		  <var n="superlatiu1"/>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</concat>
	    </let>
	  </otherwise>
	</choose>
</def-macro>


<def-macro n="el_millor_pitjor" npar="2"><!-- per a crear forma superlativa quan lema és superlatiu i l'article és definit o poss -->
       <choose>
	  <when>
	    <test>
	      <and>
		<or>
		  <equal>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.def"/>		
		  </equal>
		  <equal>
		    <clip pos="1" side="tl" part="a_det"/>
		    <lit-tag v="det.pos"/>		
		  </equal>
		</or>
		<or>
		  <equal caseless="yes">
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="millor"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="pitjor"/>
		  </equal>
		</or>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="a_adj"/>
	      <lit-tag v="adj.sint.sup"/>
	    </let>
	  </when>
	</choose> 
</def-macro>     
		

 <def-macro n="f_superlatiu1" npar="1">
   <choose>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="grau"/>
	   <lit-tag v="sup"/>
	 </equal>
       </test>
       <let>
	 <var n="superlatiu1"/>
	 <concat>
	   <get-case-from pos="1">
	     <lit v="very"/>
	   </get-case-from>
	   <lit-tag v="preadv"/>
	   <lit v="$ ^"/>
	 </concat>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lem"/>
	 <lit v="aa"/>
       </modify-case>
       <choose>
	 <when>
	   <test>
	     <equal>
	       <clip pos="1" side="tl" part="a_adj"/>
	       <lit-tag v="adj.sint.sup"/>
	     </equal>
	   </test>
	   <let>
	     <clip pos="1" side="tl" part="a_adj"/>
	     <lit-tag v="adj.sint"/>
	   </let>
	 </when>
       </choose>
     </when>
     <otherwise>
       <let>
	 <var n="superlatiu1"/>
	 <lit v=""/>
       </let>
     </otherwise>
   </choose>
 </def-macro>
	 


 <def-macro n="f_superlatiu2" npar="1"><!-- Aquesta és per quan hi ha dos adjs en una regla -->
   <choose>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="grau"/>
	   <lit-tag v="sup"/>
	 </equal>
       </test>
       <let>
	 <var n="superlatiu2"/>
	 <concat>
	   <get-case-from pos="1">
	     <lit v="very"/>
	   </get-case-from>
	   <lit-tag v="preadv"/>
	   <lit v="$ ^"/>
	 </concat>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lem"/>
	 <lit v="aa"/>
       </modify-case>
       <choose>
	 <when>
	   <test>
	     <equal>
	       <clip pos="1" side="tl" part="a_adj"/>
	       <lit-tag v="adj.sint.sup"/>
	     </equal>
	   </test>
	   <let>
	     <clip pos="1" side="tl" part="a_adj"/>
	     <lit-tag v="adj.sint"/>
	   </let>
	 </when>
       </choose>
     </when>
     <otherwise>
       <let>
	 <var n="superlatiu2"/>
	 <lit v=""/>
       </let>
     </otherwise>
   </choose>
 </def-macro>
	 



 <def-macro n="tipus_verb" npar="1">
   <choose>
     <when>
       <test>
	 <in caseless="yes">
	   <clip pos="1" side="sl" part="lem"/>
	   <list n="verbs_moviment"/>
	 </in>
       </test>
       <let>
	 <var n="tipusverb"/>
	 <lit v="mov"/>
       </let>
     </when>
     <otherwise>
       <let>
	 <var n="tipusverb"/>
	 <lit v=""/>
       </let>
     </otherwise>
   </choose>
   <choose>
     <when><!-- la variable 'lemaverb' es posa només en les etiquetes dels chunks en què pot haver-hi el lema 'saber greu', per tant no està posada en tots els chunks verbals perquè no fa falta. Amb aquesta etiqueta es pot fer un tractament de l'estructura en el t2x.-->
       <test>
	 <or>
	   <equal caseless="yes">
	     <clip pos="1" side="sl" part="lem"/>
	     <lit v="saber# greu"/>
	   </equal>
	   <equal caseless="yes">
	     <clip pos="1" side="sl" part="lem"/>
	     <lit v="saber# molt greu"/>
	   </equal>
	 </or>
       </test>
       <let>
	 <var n="lemaverb"/>
	 <lit-tag v="sabergreu"/>
       </let>
     </when>
     <otherwise>
       <let>
	 <var n="lemaverb"/>
	 <lit v=""/>
       </let>
     </otherwise>	 
   </choose>
   
 </def-macro>



 <def-macro n="conj_verb1" npar="1"><!--conjuga un verb -->

	<choose>
	  <when>
	    <test><!--Si és verb 'ser' p1 o p3 en present o passat (o subjuntiu) té una conjugació pròpia en anglès. Inclou 'ser' i 'estar', tots dos són 'vbser' en anglès (to be) -->
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="tl" part="lemh"/>
		  <lit v="be"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="ifi"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pii"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pis"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="prs"/>
		  </equal>
		</or>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p1"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="past"/>
	    </let>
	    <let>
	      <var n="temps_chunk"/>
	      <lit-tag v="past"/>
	    </let>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="1" side="tl" part="lemh"/>
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers" link-to="4"/>
		<clip pos="1" side="tl" part="nbr" link-to="5"/>
	      </concat>
	    </let>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="tl" part="lemh"/>
		  <lit v="be"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p1"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <var n="temps_chunk"/>
	      <clip pos="1" side="tl" part="temps"/>
	    </let>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="1" side="tl" part="lemh"/>
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers" link-to="4"/>
		<clip pos="1" side="tl" part="nbr" link-to="5"/>
	      </concat>
	    </let>
	  </when>


	  <when> 
	    <test><!--La resta de verbs tenen també prs i nbr per a p3 sg, excepte auxiliars (can). -->
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
		<not>
		  <equal caseless="yes">
		    <clip pos="1" side="sl" part="lem"/> 
		    <lit v="poder"/>
		  </equal>
		</not>
	      </and>
	    </test>

	    <let>
	      <var n="lema_SV"/>
	      <lit v="verbcj"/>
	    </let>
	    <let>
	      <var n="temps_chunk"/>
	      <clip pos="1" side="tl" part="temps"/>
	    </let>
	    <let>
	      <var n="verbfinal"/>
	      <concat>
		<clip pos="1" side="tl" part="lemh"/>
		<clip pos="1" side="tl" part="a_verb"/>
		<clip pos="1" side="tl" part="sep"/>
		<clip pos="1" side="tl" part="temps"/>
		<clip pos="1" side="tl" part="pers" link-to="4"/>
		<clip pos="1" side="tl" part="nbr" link-to="5"/>
	      </concat>
	    </let>

	  </when>
	  <otherwise><!--la resta de formes verbals no tenen pers i nbr en anglès -->
	    <choose>
	      <when>
		<test> 
		  <and>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		    <not>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/> 
			<lit v="poder"/>
		      </equal>
		    </not>
		  </and>
		</test>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="aux_verb"/>
		</let>
		<modify-case>
		  <clip pos="1" side="tl" part="lemh"/>
		  <lit v="aa"/>
		</modify-case>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <get-case-from pos="1">
		      <lit v="would"/>
		    </get-case-from>
		      <lit-tag v="vaux.inf"/>
		      <lit v="$ ^"/>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>


	      </when>
	      <when>
		<test> 
		  <and>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		    <equal caseless="yes">
		      <clip pos="1" side="sl" part="lem"/> 
		      <lit v="poder"/>
		    </equal>
		  </and>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="past"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>

	      <when>
		<test>		 
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="fti"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="aux_verb"/>
		</let>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/> 
			<lit v="poder"/>
		      </equal>
		    </test>
		    <let>		     
		      <clip pos="1" side="tl" part="lem"/>
		      <get-case-from pos="1">
			<lit v="be able to"/>
		      </get-case-from>
		    </let>
		    <let>		     
		      <clip pos="1" side="tl" part="a_verb"/>
		      <lit-tag v="vbmod"/>
		    </let>
		  </when>
		</choose>
		<modify-case>
		  <clip pos="1" side="tl" part="lemh"/>
		  <lit v="aa"/>
		</modify-case>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <get-case-from pos="1">
		      <lit v="will"/>
		    </get-case-from>
		      <lit-tag v="vaux.inf"/>
		      <lit v="$ ^"/>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>

	      </when>

	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/> 
		      <lit-tag v="pri"/><!--dic -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="prs"/><!--digui -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="imp"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="pres"/>
		</let>

		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>

		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="ifi"/><!--digué -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pii"/><!--deia -->
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pis"/><!--digués -->
		    </equal>
		  </or>
		</test>		   
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="past"/>
		</let>
		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="lema_SV"/>
		  <lit v="verbcj"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </when>
	       <otherwise><!--les formes no personals (inf i ger) -->

		<let>
		  <var n="temps_chunk"/>
		  <clip pos="1" side="sl" part="temps"/>
		</let>
		<let>
		  <var n="verbfinal"/>
		  <concat>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/>
		  </concat>
		</let>
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
</def-macro>


 <def-macro n="conj_haverhi_pp" npar="1"><!--conjuga el verb haver-hi quan va seguit de pp -->
    <let>
      <var n="pers_chunk"/>
      <clip pos="1" side="sl" part="pers"/>
    </let>
   <choose>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pri"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="prs"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="imp"/>
	   </equal>
	 </or>
       </test>
       <let>
	 <clip pos="1" side="tl" part="temps"/>
	 <lit-tag v="pri"/>
       </let>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <lit-tag v="ND"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi_pp"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	   <clip pos="1" side="tl" part="pers"/> 
	   <lit-tag v="5"/> 
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="ifi"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pii"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pis"/>
	   </equal>
	 </or>
       </test>		   
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="past"/>
       </let>	

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi_pp"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="cni"/>
	 </equal>


       </test>

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi_pp"/>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lemh"/>
	 <lit v="aa"/>
       </modify-case>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <get-case-from pos="1">	   
	     <lit v="would"/>
	   </get-case-from>
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="fti"/>
	 </equal>
       </test>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi_pp"/>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lemh"/>
	 <lit v="aa"/>
       </modify-case>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <get-case-from pos="1">
	     <lit v="will"/>
	   </get-case-from>
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
   </choose>
 </def-macro>


 <def-macro n="conj_haverhi" npar="1"><!--conjuga el verb haver-hi -->
    <let>
      <var n="pers_chunk"/>
      <clip pos="1" side="sl" part="pers"/>
    </let>
   <choose>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pri"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="prs"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="imp"/>
	   </equal>
	 </or>
       </test>
       <let>
	 <clip pos="1" side="tl" part="temps"/>
	 <lit-tag v="pri"/>
       </let>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <lit-tag v="ND"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	   <clip pos="1" side="tl" part="pers"/> 
	   <lit-tag v="5"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <or>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="ifi"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pii"/>
	   </equal>
	   <equal>
	     <clip pos="1" side="sl" part="temps"/>
	     <lit-tag v="pis"/>
	   </equal>
	 </or>
       </test>		   
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="past"/>
       </let>	

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="tl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <lit-tag v="ND"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="haverhi"/>
       </let>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	   <clip pos="1" side="tl" part="pers"/> 
	   <lit-tag v="5"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="cni"/>
	 </equal>


       </test>

       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi"/>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lemh"/>
	 <lit v="aa"/>
       </modify-case>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <get-case-from pos="1">
	     <lit v="would"/>
	   </get-case-from>
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
     <when>
       <test>
	 <equal>
	   <clip pos="1" side="sl" part="temps"/>
	   <lit-tag v="fti"/>
	 </equal>
       </test>
       <let>
	 <var n="temps_chunk"/>
	 <clip pos="1" side="sl" part="temps"/>
       </let>
       <let>
	 <var n="nbr_chunk"/>
	 <clip pos="1" side="sl" part="nbr"/>
       </let>
       <let>
	 <clip pos="1" side="tl" part="temps"/>		     
	 <lit-tag v="inf"/>
       </let>
       <let>
	 <var n="lema_SV"/>
	 <lit v="aux_haverhi"/>
       </let>
       <modify-case>
	 <clip pos="1" side="tl" part="lemh"/>
	 <lit v="aa"/>
       </modify-case>
       <let>
	 <var n="verbfinal"/>
	 <concat>
	   <get-case-from pos="1">
	     <lit v="will"/>
	   </get-case-from>
	   <lit-tag v="vaux.inf"/>
	   <lit v="$ ^"/>
	   <clip pos="1" side="tl" part="lemh"/>
	   <clip pos="1" side="tl" part="a_verb"/>
	   <clip pos="1" side="tl" part="temps"/>
	 </concat>
       </let>
     </when>
   </choose>
 </def-macro>




  </section-def-macros> 

  <section-rules>




    <!--*************************************** REGLES DE SN ******************************************** -->
    <rule comment="REGLA: d'aquí a NUM NOM">
      <pattern>
	<pattern-item n="de"/>
	<pattern-item n="aquí"/>
	<pattern-item n="a"/>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="5"/>
	  <with-param pos="4"/>
	</call-macro>
	<out>  
	  <chunk name="d'aquí_a_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="5" side="sl" part="gen"/></tag>
	      <tag><clip pos="5" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="tags"/>
	    </lu> 
	    <b pos="4"/>
	    <lu>     
	      <clip pos="5" side="tl" part="lemh"/> 
	      <clip pos="5" side="tl" part="a_nom"/>
	      <clip pos="5" side="tl" part="nbr" link-to="3"/>
	      <clip pos="5" side="tl" part="lemq"/>
	    </lu>
            <b pos="2"/>
	    <lu>   
	      <lit v="from"/> 
	      <lit-tag v="pr"/>
	    </lu> 
            <b pos="3"/>
	    <lu>   
	      <lit v="now"/> 
	      <lit-tag v="adv"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>
    <rule comment="REGLA: fa NUM NOM">
      <pattern>
	<pattern-item n="fa"/>
	<pattern-item n="num"/>
	<pattern-item n="periode"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	</call-macro>
	<out>  
	  <chunk name="fa_num_nom" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="tags"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>     
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="nbr" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>
	    </lu>
            <b pos="1"/>
	    <lu>   
	      <lit v="ago"/> 
	      <lit-tag v="adv"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>

    <rule comment="REGLA: NOM (per a col·locar la cua en les multiparaules amb g">
      <pattern>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_nom">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk namefrom="tipusnom_chunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag><!--es manté per finalitats informatives -->
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

<rule comment="REGLA: ANTROPÒNIM">
      <pattern>
	<pattern-item n="ant"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="ant" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


<rule comment="REGLA: DET ANTROPÒNIM (La Maria - Maria)">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="ant"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="ant" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
      </action>
    </rule>



    <rule comment="REGLA: DET NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_nom">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="el"/>
              </equal>
            </test>
	    <let>	      
	      <var n="lema_chunk"/> 
	      <concat>
		<lit v="el_"/> 
		<var n="tipusnom_chunk"/>
	      </concat>
	    </let>
          </when>
          <otherwise>
	    <let>	      
	      <var n="lema_chunk"/> 
	      <concat>
		<lit v="det_"/> 
		<var n="tipusnom_chunk"/>
	      </concat>
	    </let>
          </otherwise>
        </choose>
	<out>
	  <chunk namefrom="lema_chunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>	 
      </action>
    </rule>


    <rule comment="REGLA: NUM NOM">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>       
       <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="lem"/>
                <lit v="any"/>
              </equal>
            </test>
           <let>             
             <var n="lema_chunk"/> 
             <lit v="num_year"/> 
           </let>
          </when>
          <otherwise>
           <let>             
             <var n="lema_chunk"/> 
             <lit v="num_nom"/> 
           </let>
          </otherwise>
        </choose>
	<out>  
	  <chunk namefrom="lema_chunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="tags"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>     
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>



    <rule comment="REGLA: NOM ADJ">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_nom">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_concord2">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>
        <let>
          <var n="lema_chunk"/>
          <concat>
            <var n="tipusnom_chunk"/>
            <lit v="_adj"/>
          </concat>
        </let>
	<out> 
	  <chunk namefrom="lema_chunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>       
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>

    <rule comment="REGLA: NOM ADJ ADJ">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_nom">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_superlatiu2">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>	
        <let>
          <var n="lema_chunk"/>
          <concat>
            <var n="tipusnom_chunk"/>
            <lit v="_adj_adj"/>
          </concat>
        </let>
	<out> 
	  <chunk namefrom="lema_chunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <var n="superlatiu2"/>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_nom"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>     
      </action>
    </rule>
    


    <rule comment="REGLA: DET NOM ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_nom">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="el"/>
              </equal>
            </test>
           <let>             
             <var n="lema_chunk"/> 
             <concat>
               <lit v="el_"/> 
               <var n="tipusnom_chunk"/>
               <lit v="_adj"/> 
             </concat>
           </let>
          </when>
          <otherwise>
           <let>             
             <var n="lema_chunk"/> 
             <concat>
               <lit v="det_"/> 
               <var n="tipusnom_chunk"/>
               <lit v="_adj"/> 
             </concat>
           </let>
          </otherwise>
        </choose>
	<out>  
	  <chunk namefrom="lema_chunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>     
      </action>
    </rule>



    <rule comment="REGLA: DET ADJ NOM">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="tipus_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="el_millor_pitjor">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	</call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="el"/>
              </equal>
            </test>
           <let>             
             <var n="lema_chunk"/> 
             <concat>
               <lit v="el_"/> 
               <lit v="adj_"/> 
               <var n="tipusnom_chunk"/>
             </concat>
           </let>
          </when>
          <otherwise>
           <let>             
             <var n="lema_chunk"/> 
             <concat>
               <lit v="det_"/> 
               <lit v="adj_"/> 
               <var n="tipusnom_chunk"/>
             </concat>
           </let>
          </otherwise>
        </choose>
	<out>  
	  <chunk namefrom="lema_chunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="nbr" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>


 <rule comment="REGLA: DET ADJ NOM ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="el_millor_pitjor">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="f_superlatiu2">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="3"/>
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="el"/>
              </equal>
            </test>
           <let>             
             <var n="lema_chunk"/> 
             <concat>
               <lit v="el_"/> 
               <lit v="_adj"/> 
               <var n="tipusnom_chunk"/>
               <lit v="_adj"/> 
             </concat>
           </let>
          </when>
          <otherwise>
           <let>             
             <var n="lema_chunk"/> 
             <concat>
               <lit v="det_"/> 
               <lit v="adj_"/> 
               <var n="tipusnom_chunk"/>
               <lit v="_adj"/> 
             </concat>
           </let>
          </otherwise>
        </choose>
	<out>  
	  <chunk namefrom="lema_chunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="3" side="sl" part="gen"/></tag>
	      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <var n="superlatiu2"/>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>       
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_nom"/>
	      <clip pos="3" side="tl" part="nbr" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>


 <rule comment="REGLA: DET NOM ADJ ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="tipus_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="f_superlatiu2">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="el"/>
              </equal>
            </test>
           <let>             
             <var n="lema_chunk"/> 
             <concat>
               <lit v="el_"/> 
               <var n="tipusnom_chunk"/>
               <lit v="_adj"/> 
               <lit v="_adj"/> 
             </concat>
           </let>
          </when>
          <otherwise>
           <let>             
             <var n="lema_chunk"/> 
             <concat>
               <lit v="det_"/> 
               <var n="tipusnom_chunk"/>
               <lit v="_adj"/> 
               <lit v="_adj"/> 
             </concat>
           </let>
          </otherwise>
        </choose>
	<out>  
	  <chunk namefrom="lema_chunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu2"/>
	      <clip pos="4" side="tl" part="lem"/> 
	      <clip pos="4" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="3"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>    
      </action>
    </rule>



    <rule comment="REGLA: NUM NOM ADJ">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_nom">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	</call-macro>
        <let>
          <var n="lema_chunk"/>
          <concat>
            <lit v="num_"/>
            <var n="tipusnom_chunk"/>
            <lit v="_adj"/>
          </concat>
        </let>
	<out>  
	  <chunk namefrom="lema_chunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="3" side="tl" part="lem"/> 
	      <clip pos="3" side="tl" part="a_adj"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>       
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>  
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


    <rule comment="REGLA: DET NOM ADV ADJ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="tipus_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_superlatiu1"><!--aquí no envio variable 'superlatiu' perquè s'envia dins de adv_adjectiu -->
	  <with-param pos="4"/>
	</call-macro>	
	<call-macro n="det_adv_adj">
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="el"/>
              </equal>
            </test>
           <let>             
             <var n="lema_chunk"/> 
             <concat>
               <lit v="el_"/> 
               <var n="tipusnom_chunk"/>
               <lit v="_adv"/> 
               <lit v="_adj"/> 
             </concat>
           </let>
          </when>
          <otherwise>
           <let>             
             <var n="lema_chunk"/> 
             <concat>
               <lit v="det_"/> 
               <var n="tipusnom_chunk"/>
               <lit v="_adv"/> 
               <lit v="_adj"/> 
             </concat>
           </let>
          </otherwise>
        </choose>
	<out>  
	  <chunk namefrom="lema_chunk" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu>
	    <b pos="1"/>
            <lu>
	      <var n="adv_adjectiu"/>
	    </lu>
	    <b pos="2"/>
	    <lu>         
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out> 
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>    
      </action>
    </rule>

    <rule comment="REGLA: NUM NOM ADV ADJ">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="nom"/>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_superlatiu1"><!--aquí no envio variable 'superlatiu' perquè s'envia dins de adv_adjectiu -->
	  <with-param pos="4"/>
	</call-macro>	
	<call-macro n="adv_adj">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="4"/>
	</call-macro>
	<out>  
	  <chunk name="num_nom_adv_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
            <lu>
	      <var n="adv_adjectiu"/>
	    </lu>
	    <b pos="2"/>
	    <lu>         
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_nom"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>   
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro> 
      </action>
    </rule>



    <rule comment="REGLA: NOM ADJ conj ADJ NOM (aspecte fràgil i tímida aparença -> fragile look and shy appearance. Regla creada perquè no entrin frases que no toquen en la regla següent">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_superlatiu2">
	  <with-param pos="4"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="4" side="sl" part="gen"/>
		  <clip pos="5" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="4" side="sl" part="nbr"/>
		  <clip pos="5" side="sl" part="nbr"/>
		</equal>
	      </and>
	    </test>	
	    <call-macro n="f_concord2">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>	
	    <call-macro n="f_concord2">
	      <with-param pos="5"/>
	      <with-param pos="4"/>
	    </call-macro>
	    <call-macro n="elimina_ND">
	      <with-param pos="5"/>
	    </call-macro>

	    <out>
	      <chunk name="nom_adj_coo_adj_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu> 
		  <var n="superlatiu1"/>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu> 
		<b pos="4"/>
		<lu>
		  <clip pos="5" side="tl" part="lemh"/> 
		  <clip pos="5" side="tl" part="a_nom"/>
		  <clip pos="5" side="tl" part="nbr"/>
		  <clip pos="5" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>	
	    <call-macro n="f_concord3">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	      <with-param pos="4"/>
	    </call-macro>
	    <out> 
	      <chunk name="nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>  
		  <var n="superlatiu1"/> 
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="2"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu> 
		<b pos="3"/>
		<lu>       
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
	      </chunk>	      
	      <b pos="4"/>
	    </out>
	    <out>
	      <chunk name="nom">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="5" side="sl" part="gen"/></tag>
		  <tag><clip pos="5" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="5" side="tl" part="lemh"/> 
		  <clip pos="5" side="tl" part="a_nom"/>
		  <clip pos="5" side="tl" part="nbr" link-to="3"/>
		  <clip pos="5" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose> 
      </action>
    </rule>

    <rule comment="REGLA: NOM ADJ conj ADJ (aspecte fràgil i tímid -> fragile and shy look">
      <pattern>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
      </pattern>
      <action><!--Pot haver-hi errors per lo de mf perquè pot ser que un sigui m i l'altra f perquè el tagger s'hagi equivocat (noia bonica i interessant). No donarà error en frases com "aspecte fràgil i tímida aparença" perquè entraran per la regla anterior. mireia adequar a novetat mf -->
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_superlatiu2">
	  <with-param pos="4"/>
	</call-macro>
	<call-macro n="f_concord3">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="4"/>
	</call-macro>
<!--	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="gen"/>
		  <clip pos="4" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <clip pos="4" side="sl" part="nbr"/>
		</equal>
	      </and>
	    </test> -->
	    <out> 
	      <chunk name="nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <var n="superlatiu1"/>
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="2"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu> 
		<b pos="3"/>
		<lu>       
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	<!--  </when>
	  <otherwise>
	    <out>
	      <chunk name="nom_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="1" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		</tags>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/> 
		  <clip pos="2" side="tl" part="a_adj"/>
		</lu> 
		<b pos="1"/>
		<lu>       
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_nom"/>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="tl" part="lemq"/>  
		</lu>
	      </chunk>	       
	      <b pos="2"/>
	      <chunk name="coo_adj">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="4" side="sl" part="gen"/></tag>
		  <tag><clip pos="4" side="sl" part="nbr"/></tag>
		</tags>		 
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_adj"/>
		</lu>
	      </chunk>
	    </out>	 
	  </otherwise>
	</choose>      --> 
      </action>
    </rule>


    <rule comment="REGLA: DET NOM ADJ conj ADJ NOM (un aspecte fràgil i tímida aparença -> a fragile look and shy appearance. Regla creada perquè no entrin frases que no toquen en la regla següent)"> 
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj_pp"/>
	<pattern-item n="nom"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="f_superlatiu2">
	  <with-param pos="5"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="5" side="sl" part="gen"/>
		  <clip pos="6" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="5" side="sl" part="nbr"/>
		  <clip pos="6" side="sl" part="nbr"/>
		</equal>
	      </and>
	    </test>
	    <call-macro n="f_concord3">
	      <with-param pos="2"/>
	      <with-param pos="1"/>
	      <with-param pos="3"/>
	    </call-macro>	
	    <call-macro n="f_concord2">
	      <with-param pos="6"/>
	      <with-param pos="5"/>
	    </call-macro>
	    <call-macro n="elimina_ND">
	      <with-param pos="6"/>
	    </call-macro>
	    <out>
	      <chunk name="det_nom_adj_coo_adj_nom" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		  <tag><var n="nombre"/></tag>
		</tags>

		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <var n="superlatiu1"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
		<b pos="3"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
		<b pos="5"/>
		<lu>
		  <clip pos="6" side="tl" part="lemh"/> 
		  <clip pos="6" side="tl" part="a_nom"/>
		  <clip pos="6" side="tl" part="nbr"/>
		  <clip pos="6" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <call-macro n="f_concord4">
	      <with-param pos="2"/>
	      <with-param pos="1"/>
	      <with-param pos="3"/>
	      <with-param pos="5"/>
	    </call-macro>
	    <out> 
	      <chunk name="det_nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>  
		  <var n="superlatiu1"/> 
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
		<b pos="4"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	      <b pos="5"/>
	    </out>
	    <out>
	      <chunk name="nom">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="6" side="sl" part="gen"/></tag>
		  <tag><clip pos="6" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="6" side="tl" part="lemh"/> 
		  <clip pos="6" side="tl" part="a_nom"/>
		  <clip pos="6" side="tl" part="nbr" link-to="3"/>
		  <clip pos="6" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
	  </otherwise>
	</choose>     
      </action>
    </rule>

    <rule comment="REGLA: DET NOM ADJ conj ADJ (un aspecte fràgil i tímid -> a fragile and shy look">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="nom"/>
	<pattern-item n="adj"/>
	<pattern-item n="cnjcoo"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>		
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="nombre_nom">
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="3"/>
	</call-macro>	
	<call-macro n="f_superlatiu2">
	  <with-param pos="5"/>
	</call-macro>	
	<call-macro n="canvia_det">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="f_concord4">
	  <with-param pos="2"/>
	  <with-param pos="1"/>
	  <with-param pos="3"/>
	  <with-param pos="5"/>
	</call-macro>
<!--	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="gen"/>
		  <clip pos="5" side="sl" part="gen"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <clip pos="5" side="sl" part="nbr"/>
		</equal>
	      </and>		
	    </test> -->
	    <out> 
	      <chunk name="det_nom_adj_coo_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <var n="superlatiu1"/>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="3"/>
		<lu>   
		  <var n="superlatiu2"/>
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
		<b pos="4"/>
		<lu>       
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr" link-to="3"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>
	    </out>
<!--	  </when>
	  <otherwise>	      
	    <out>
	      <chunk name="det_nom_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><var n="nombre"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu>
		<b pos="1"/>
		<lu>   
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_adj"/>
		</lu> 
		<b pos="2"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_nom"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>
	      </chunk>	       
	      <b pos="3"/>
	      <chunk name="coo_adj">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="5" side="sl" part="gen"/></tag>
		  <tag><clip pos="5" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="4" side="tl" part="whole"/> 
		</lu>
		<b pos="4"/>
		<lu>   
		  <clip pos="5" side="tl" part="lem"/> 
		  <clip pos="5" side="tl" part="a_adj"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>     --> 
      </action>
    </rule>

    <rule comment="REGLA: ADJECTIU (quan no acompanya res o va amb desconeguda)">
      <pattern>
	<pattern-item n="adj"/>
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="1"/>
	</call-macro>	
	<out>
	  <chunk name="adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_adj"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule> 


    <rule comment="REGLA: ADV ADJECTIU (per a fer comparatius i superlatius: 'més llarg - longer')">
      <pattern>
	<pattern-item n="adv_preadv"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    	
	<call-macro n="f_superlatiu1"><!--'sempre boníssim' --><!--aquí no envio variable 'superlatiu' perquè s'envia dins de adv_adjectiu -->
	  <with-param pos="2"/>
	</call-macro>	
	<call-macro n="adv_adj">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	    <out>
	      <chunk name="adv_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="2" side="sl" part="gen"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu> 
		  <var n="adv_adjectiu"/>
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
      </action>
    </rule> 


 <rule comment="REGLA: DET ADJECTIU (el lleig / el millor) ">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="adj"/>
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="f_superlatiu1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="el_millor_pitjor">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="sl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		</test>
		<let>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="2" side="sl" part="nbr"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>		
	<out>
	  <chunk name="det_adj" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <var n="superlatiu1"/>
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_adj"/>
	    </lu> 
	  </chunk>
	</out>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
      </action>
    </rule> 




   <rule comment="REGLA: DET ADV ADJECTIU (per a fer comparatius i superlatius: 'la més gran - the biggest; la més important - the most important')">
      <pattern>
	<pattern-item n="det"/>
	<pattern-item n="més"/>
	<pattern-item n="adj_pp"/>
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when><!--trampeta per quan el 'més' no és adv sinó determinant, per a arreglar-ho. -->
	    <test>
	      <equal>
		<clip pos="2" side="sl" part="a_adv"/> 
		<lit v=""/>
	      </equal>
	    </test>
	    <let>	      
	      <clip pos="2" side="tl" part="whole"/> 
	      <concat>
		<clip pos="2" side="tl" part="lem"/> 
		<lit-tag v="adv"/>
	      </concat>
	    </let>
	  </when>
	</choose>	
	<call-macro n="det_adv_adj">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>	 

	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="nbr"/>
		<lit-tag v="ND"/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="3" side="sl" part="nbr"/>
		      <lit-tag v="sp"/>
		    </equal>
		  </not>
		</test>
		<let>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="3" side="sl" part="nbr"/>
		</let>
	      </when>
	    </choose>
	  </when>
	</choose>
	      
<!--	<choose>
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/> 
		  <lit v="més"/>
		</equal>
		<equal>
		  <clip pos="2" side="tl" part="a_adj"/> 
		  <lit-tag v="adj.sint"/>
		</equal>
	      </and>
	    </test> -->
	    <out>
	      <chunk name="det_adv_adj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SA"/></tag>
		  <tag><clip pos="3" side="sl" part="gen"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="1" side="tl" part="lem"/> 
		  <clip pos="1" side="tl" part="a_det"/>
		  <clip pos="1" side="tl" part="nbr" link-to="3"/>
		</lu>
		<b pos="1"/>
		<lu> 
		  <var n="adv_adjectiu"/>
		</lu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
      </action>
    </rule> 


    <rule comment="REGLA: DETERMINANT (perquè no doni error si va davant de desconegudes i no es pot assignar nombre. MG: falta regla t2x per al ND)">
      <pattern>
	<pattern-item n="det"/>
      </pattern>
      <action>        	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>  
	  <chunk name="det" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="DET"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="nbr" link-to="3"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>



<rule comment="REGLA: el (num)%">
      <pattern>
	<pattern-item n="el"/>
	<pattern-item n="percent"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="percent">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="2" side="tl" part="whole"/>   
	    </lu>
	  </chunk>
	</out> 
      </action>
</rule>





<rule comment="REGLA: a Girona -> in Girona">
      <pattern>
	<pattern-item n="a"/>
	<pattern-item n="loc"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <not>
		<equal>
		  <var n="tipusverb"/>
		  <lit v="mov"/>
		</equal>
	      </not>
	    </test>		
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <get-case-from pos="1">
		<lit v="in"/>
	      </get-case-from>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="loc" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SP"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="1" side="tl" part="whole"/>   
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>   
	    </lu>
	  </chunk>
	</out> 
      </action>
</rule>



<rule comment="REGLA: a l'Iraq -> in Irak">
  <pattern>
    <pattern-item n="a"/>
    <pattern-item n="detdef"/>
    <pattern-item n="loc"/>
  </pattern>
  <action>    	
    <call-macro n="firstWord">
      <with-param pos="1"/>
    </call-macro>
  <!--  <call-macro n="f_concord2">
      <with-param pos="3"/>
      <with-param pos="2"/>
    </call-macro> -->
    <choose>
      <when>
	<test>
	  <not>
	    <equal>
	      <var n="tipusverb"/>
	      <lit v="mov"/>
	    </equal>
	  </not>
	</test>		
	<let>
	  <clip pos="1" side="tl" part="lem"/>
	  <get-case-from pos="1">
	    <lit v="in"/>
	  </get-case-from>
	</let>
      </when>
    </choose>
    <choose>
      <when>
	<test>
	  <not>
	    <in caseless="yes">
	      <clip pos="3" side="sl" part="lem"/>
	      <list n="np_article"/>
	    </in>
	  </not>
	</test>  
	<out><!--envia l'article (in the United States) -->
	  <chunk name="loc" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SP"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="1" side="tl" part="whole"/>   
	    </lu>
	    <b pos="1"/>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/> 
	      <clip pos="2" side="tl" part="a_det"/>
	      <clip pos="2" side="tl" part="nbr" link-to="3"/>
	    </lu> 
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>   
	    </lu>
	  </chunk>
	</out> 
      </when>
      <otherwise>
	<out><!--no enviïs l'article -->
	  <chunk name="loc" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SP"/></tag>
	      <tag><clip pos="2" side="sl" part="gen"/></tag>
	      <tag><clip pos="2" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu> 
	      <clip pos="1" side="tl" part="whole"/>   
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>   
	    </lu>
	  </chunk>
	</out> 
	<call-macro n="f_bcond">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>
      </otherwise>
    </choose>
  </action>
</rule>



    <!-- *************************************** REGLES DE SV *********************************************** -->


    <rule comment="REGLA: CALDRE">
      <pattern>
	<pattern-item n="caldre"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verb">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when><!--Si és en sg, envia el pronom subjecte 'it'. En plural caldria fer transformacions al t2x (calen 3 persones - 3 persons are necessary) -->
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="prpers" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><lit-tag  v="subj"/></tag>
		  <tag><lit-tag  v="p3"/></tag>
		  <tag><lit-tag  v="nt"/></tag>
		  <tag><lit-tag  v="sg"/></tag>
		</tags>
		<lu>   
		  <get-case-from pos="1">
		    <lit v="prpers"/> 
		  </get-case-from>
		  <lit-tag v="prn"/>  
		  <lit-tag v="2"/> 
		  <lit-tag v="p3"/>
		  <lit-tag v="nt"/>
		  <lit-tag v="sg"/>
		</lu> 
	      </chunk>
	      <b/>
	    </out> 
	    <let>
		<var n="caseFirstWord"/>
		<lit v="aa"/>
	    </let> 
	  </when>
	</choose>	  
	<choose>
	  <when>
	    <test>
	      <and>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="ifi"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pii"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="pis"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="prs"/>
		  </equal>
		</or>		
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="past"/>
	    </let>
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="sep"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <clip pos="1" side="tl" part="pers"/>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/> 
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="sep"/>
		  <clip pos="1" side="tl" part="temps"/>
		  <clip pos="1" side="tl" part="pers"/>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="1" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  
	  <otherwise><!--la resta de formes verbals no tenen pers i nbr en anglès -->
	    <choose>
	      <when>
		<test> 
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>
		<modify-case>
		  <clip pos="1" side="tl" part="lemh"/>
		  <lit v="aa"/>
		</modify-case>
		<out>
		  <chunk name="aux_verb" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="1">
			<lit v="would"/>
		      </get-case-from>
		      <lit-tag v="vaux.inf"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/> 
		      <clip pos="1" side="tl" part="a_verb"/> 
		      <clip pos="1" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		      <clip pos="1" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>  
	      <when>
		<test>		 
		  <equal>
		    <clip pos="1" side="sl" part="temps"/>
		    <lit-tag v="fti"/>
		  </equal>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>	
		<out>
		  <chunk name="aux_verb" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="1">
		      <lit v="will"/>
		      </get-case-from>
		      <lit-tag v="vaux.inf"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/> 
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		      <clip pos="1" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/> 
		      <lit-tag v="pri"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="prs"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="imp"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="pres"/>
		</let>
		<out>
		  <chunk name="verbcj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/> 
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		      <clip pos="1" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="ifi"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pii"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="temps"/>
		      <lit-tag v="pis"/>
		    </equal>
		  </or>
		</test>		   
		<let>
		  <clip pos="1" side="tl" part="temps"/>		     
		  <lit-tag v="past"/>
		</let>
		<out>
		  <chunk name="verbcj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/> 
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/> 
		      <clip pos="1" side="tl" part="temps"/>
		      <clip pos="1" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>


    <rule comment="REGLA: VERB conjugat">
      <pattern>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="conj_verb1">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="donar_per">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verb">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/> 
	      <clip pos="1" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


    <rule comment="ANAR + INF (vaig venir - came)">
      <pattern>
	<pattern-item n="anar"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="2"/>
	</call-macro> 
	<let>
	  <clip pos="2" side="tl" part="temps"/>		     
	  <lit-tag v="past"/>
	</let>
	<choose>
	  <when>
	    <test><!--Si és verb 'ser' p1 o p3  té una conjugació pròpia en anglès -->
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="tl" part="lemh"/>
		  <lit v="be"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p1"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="1" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		  <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="1" side="tl" part="pers"/>
		  <clip pos="1" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		  <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>          
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="sep"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="lemq"/>                  
		</lu> 
	      </chunk>
	    </out>  
	  </otherwise>
	</choose>
	<call-macro n="f_bcond">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro> 
      </action>
    </rule>

    <rule comment="ANAR + INF +enc (vaig comprar-los - bought them) (MG: falta el mateix amb dos enclítics">
      <pattern>
	<pattern-item n="anar"/> 
	<pattern-item n="inf"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   	
	<call-macro n="tipus_verb">
	  <with-param pos="2"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>		     
	  <lit-tag v="past"/>
	</let>
	<choose>      
	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (vaig treure'l -> took it out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="2" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <out>
	      <chunk name="verbcj_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		  <tag><var n="lemaverb"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="2" side="tl" part="lemh"/>
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="sep"/>
		    <clip pos="2" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <clip pos="3" side="tl" part="a_prn"/>
		    <clip pos="3" side="tl" part="tipus_prn"/>
		    <clip pos="3" side="tl" part="pers"/>
		    <clip pos="3" side="tl" part="gen"/>
		    <clip pos="3" side="tl" part="nbr"/>		           
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem els blancs -->
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <call-macro n="f_bcond"> 
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	  </when>
	  <otherwise> <!--si no és un verb separable...-->
	    <choose>
	      <when>
		<test><!--mirem si és el verb "ser" -->
		  <and>
		    <equal caseless="yes">
		      <clip pos="2" side="tl" part="lemh"/>
		      <lit v="be"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="pers"/>
			<lit-tag v="p1"/>
		      </equal>
		      <equal>
			<clip pos="1" side="sl" part="pers"/>
			<lit-tag v="p3"/>
		      </equal>
		    </or>
		    <equal>
		      <clip pos="1" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </and>
		</test>
		<out>
		  <chunk name="verbcj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><var n="lemaverb"/></tag>
		    </tags>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="nbr"/>
		      <clip pos="2" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	      <otherwise> <!-- si no és el verb ser, l'enviem sense pers ni nbr-->
		<out>
		  <chunk name="verbcj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		      <tag><var n="lemaverb"/></tag>
		    </tags>
		    <lu>          
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/>
		      <clip pos="2" side="tl" part="temps"/>
		      <clip pos="2" side="tl" part="lemq"/>                  
		    </lu> 
		  </chunk>
		</out>  
	      </otherwise>
	    </choose>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>  
	    <choose><!--I ara que ja hem imprès el verb, mirem els proclítics -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="2" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="3" side="sl" part="lem"/>
			<lit v="es"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="2"/>
	          <with-param pos="3"/>
		</call-macro>
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="3" side="sl" part="lem"/>
			<lit v="es"/>
		      </equal>
		    </test>
		    <let>
		      <var n="lema"/>
		      <lit v="ref"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="ref"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema"/>
		      <lit v="pro"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="SN"/>
		    </let>
		  </otherwise>
		</choose>		
		<out>
		  <b pos="2"/>
		  <chunk namefrom="lema">
		    <tags>
		      <tag><var n="nom_chunk"/></tag>
		      <tag><clip pos="3" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="3" side="sl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="3" side="tl" part="lem"/>
		      <clip pos="3" side="tl" part="a_prn"/>
		      <clip pos="3" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="3" side="tl" part="pers"/>
		      <clip pos="3" side="tl" part="gen"/>
		      <clip pos="3" side="tl" part="nbr"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>  
	  </otherwise>
	</choose>
      </action>
    </rule>
	 
    <rule comment="pro ANAR + INF (els vaig comprar - bought them)">
      <pattern>
	<pattern-item n="pro"/> 
	<pattern-item n="anar"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>   
	<let>
	  <clip pos="3" side="tl" part="temps"/>		     
	  <lit-tag v="past"/>
	</let>
	<choose>    <!--Mira si és 'haver-hi' (hi va haver) -->
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>		     
		  <lit v="hi"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="3" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <get-case-from pos="3">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <out>
	      <chunk name="haverhi" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		  <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lem"/> 
		  <clip pos="3" side="tl" part="a_verb"/> 
		  <clip pos="3" side="tl" part="temps"/> 
		  <clip pos="2" side="tl" part="pers"/> 		 
		  <lit-tag v="5"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>

	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (vaig treure'l -> took it out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="3" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <out>
	      <chunk name="verbcj_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		  <tag> <var n="lemaverb"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="3" side="tl" part="lemh"/>
		    <clip pos="3" side="tl" part="a_verb"/>
		    <clip pos="3" side="tl" part="sep"/>
		    <clip pos="3" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="1" side="tl" part="lem"/>
		    <clip pos="1" side="tl" part="a_prn"/>
		    <clip pos="1" side="tl" part="tipus_prn"/>
		    <clip pos="1" side="tl" part="pers"/>
		    <clip pos="1" side="tl" part="gen"/>
		    <clip pos="1" side="tl" part="nbr"/>		           
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem els blancs -->
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <call-macro n="f_bcond"> 
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	  </when>
	  <otherwise> <!--si no és un verb separable...-->
	    <choose>
	      <when>
		<test><!--mirem si és el verb "ser" -->
		  <and>
		    <equal caseless="yes">
		      <clip pos="3" side="tl" part="lemh"/>
		      <lit v="be"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="2" side="sl" part="pers"/>
			<lit-tag v="p1"/>
		      </equal>
		      <equal>
			<clip pos="2" side="sl" part="pers"/>
			<lit-tag v="p3"/>
		      </equal>
		    </or>
		    <equal>
		      <clip pos="2" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </and>
		</test>
		<out>
		  <chunk name="verbcj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="3" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		      <tag><var n="lemaverb"/></tag>
		    </tags>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="temps"/>
		      <clip pos="2" side="tl" part="pers" link-to="4"/>
		      <clip pos="2" side="tl" part="nbr" link-to="5"/>
		      <clip pos="3" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	      <otherwise> <!-- si no és el verb ser, l'enviem sense pers ni nbr-->
		<out>
		  <chunk name="verbcj" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="3" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		    </tags>
		    <lu>          
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="sep"/>
		      <clip pos="3" side="tl" part="temps"/>
		      <clip pos="3" side="tl" part="lemq"/>                  
		    </lu> 
		  </chunk>
		</out>  
	      </otherwise>
	    </choose>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>  
	    <choose><!--I ara que ja hem imprès el verb, mirem els proclítics -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="2" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="2" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="2"/>
	          <with-param pos="3"/>
		</call-macro>
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/>
		      </equal>
		    </test>
		    <let>
		      <var n="lema"/>
		      <lit v="ref"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="ref"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema"/>
		      <lit v="pro"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="SN"/>
		    </let>
		  </otherwise>
		</choose>		
		<out>
		  <b pos="2"/>
		  <chunk namefrom="lema">
		    <tags>
		      <tag><var n="nom_chunk"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>  
	  </otherwise>
	</choose>
      </action>
    </rule>


    <rule comment="pro + pro + ANAR + INF (m'ho va donar - gave it to me)">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="pro"/>  
	<pattern-item n="anar"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="4"/>
	</call-macro>   
	<let>
	  <clip pos="4" side="tl" part="temps"/>		     
	  <lit-tag v="past"/>
	</let>
	<choose>
	  <!--Mira si és 'haver-hi' (n'hi va haver) -->
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>		     
		  <lit v="hi"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="4" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="4" side="tl" part="lem"/>
	      <get-case-from pos="4">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="4" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <out>
	      <chunk name="haverhi" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="4" side="tl" part="temps"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_verb"/> 
		  <clip pos="4" side="tl" part="temps"/> 
		  <clip pos="3" side="tl" part="pers"/> 		 
		  <lit-tag v="5"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <!-- si el verb és separable, posa el 2n clític entre el verb i la cua (me'l va treure -> took it out (...))-->
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="sep"/>
		<lit-tag v="sep"/>	
	      </equal>
	    </test>
	    <out>
	      <chunk name="verbcj_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="4" side="tl" part="temps"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		  <tag><var n="lemaverb"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="4" side="tl" part="lemh"/>
		    <clip pos="4" side="tl" part="a_verb"/>
		    <clip pos="4" side="tl" part="sep"/>
		    <clip pos="4" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="4" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem els blancs -->
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	  </when>
	  <otherwise> <!--si no és un verb separable, imprimeix primer el verb i despres el pron-->
	    <out>
	      <chunk name="verbcj" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="4" side="tl" part="temps"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>          
		  <clip pos="4" side="tl" part="lemh"/>
		  <clip pos="4" side="tl" part="a_verb"/>
		  <clip pos="4" side="tl" part="sep"/>
		  <clip pos="4" side="tl" part="temps"/>
		  <clip pos="4" side="tl" part="lemq"/>                  
		</lu> 
	      </chunk>
	      <b pos="1"/>
	      <chunk name="pro"> 
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>   
		  <clip pos="2" side="tl" part="lem"/>
		  <clip pos="2" side="tl" part="a_prn"/>
		  <clip pos="2" side="tl" part="tipus_prn" link-to="2"/>
		  <clip pos="2" side="tl" part="pers"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu> 
	      </chunk>
	    </out> 
	  </otherwise>
	</choose>
	<choose><!--ara mirem el primer pronom  -->
	  <when>
	    <test>
	      <not><!--si no es dóna el cas que... --> 
		<or>
		  <and><!--o el verb és pronominal -->
		    <equal>
		      <clip pos="4" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and><!--o el primer enclític es tradueix per res (en/hi/[se]) -->
		  <equal>
		    <clip pos="1" side="tl" part="whole"/>
		    <lit v=""/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose><!--imprimeix 'to + prn' excepte si el 2n pronom tenia traducció buida i el verb no era separable -->
	      <when>
		<test>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="tl" part="whole"/>
			<lit v=""/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="4" side="tl" part="sep"/>
			  <lit-tag v="sep"/>	
			</equal>
		      </not>
		    </and>
		  </not>
		</test>
		<out>
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>	
		    <b pos="2"/>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	  <otherwise> <!--si el 2n pronom tenia trad buida i el verb no era separable, imprimeix el primer pronom directament sense la prep 'to' -->
	
		<out>
		  <chunk name="pro">
		    <tags>
		      <tag><lit-tag v="SN"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <b pos="2"/>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>
		<call-macro n="f_bcond"> 
		  <with-param pos="3"/>
	          <with-param pos="4"/>
		</call-macro>
	  </otherwise>
	</choose>
	  </when>
	  <otherwise>
	    <call-macro n="f_bcond"> 
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	    <call-macro n="f_bcond"> 
	      <with-param pos="3"/>
	      <with-param pos="4"/>
	    </call-macro>
	  </otherwise>
	    
	</choose>
      </action>

	
    </rule>
    




    <rule comment="HAVER + PP (han vist - have seen)">
      <pattern>
	<pattern-item n="haver"/>
	<pattern-item n="pp"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="2"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/> 
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<call-macro n="conj_verb1">
	  <with-param pos="1"/>
	</call-macro>
	<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="cni"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="aux_haver_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="haver_pp"/>
	    </let>
	  </otherwise>
	</choose>	
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="1" side="tl" part="pers"/></tag>
		  <tag><clip pos="1" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_pp"/>
		  <clip pos="2" side="tl" part="lemq"/>    
		</lu> 
	      </chunk>
	    </out>
      </action>
    </rule>


    <rule comment="pro HAVER + PP (l'han vist - have seen it)">
      <pattern>
	<pattern-item n="pro"/> 
	<pattern-item n="haver"/> 
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>   
	<choose>
	  <when><!--Mira si és 'haver-hi'  -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>		     
		  <lit v="hi"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="3" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <get-case-from pos="3">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi_pp">
	      <with-param pos="2"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lem"/>
		  <clip pos="3" side="tl" part="a_pp"/>
		</lu> 		  
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--Si no és 'haver-hi' -->
	    <choose>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="3" side="sl" part="lem"/> 
		    <lit v="poder"/>
		  </equal>
		</test>
		<let>
		  <clip pos="3" side="tl" part="lem"/> 
		  <get-case-from pos="3">
		    <lit v="be able to"/>
		  </get-case-from>
		</let>
		<let>
		  <clip pos="3" side="tl" part="a_pp"/> 
		  <lit-tag v="vbmod.pp"/>
		</let>
	      </when>
	    </choose>
	    <call-macro n="conj_verb1">
	      <with-param pos="2"/>
	    </call-macro>
	    <!-- aquí s'ha de mirar la separabilitat-->
	    <choose>
	      <when>
		<!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (l'he tret -> have taken it out)-->
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="tl" part="sep"/>
		      <lit-tag v="sep"/>	
		    </equal>
		    <not>
		      <equal>
			<clip pos="3" side="sl" part="pron"/>
			<lit-tag v="pron"/>
		      </equal>
		    </not>
		  </and>
		</test>
		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp_enc"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp_enc"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	     <tag> <var n="lemaverb"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="1"/>
		    <mlu>
		      <lu>
			<clip pos="3" side="tl" part="lemh"/> 
			<clip pos="3" side="tl" part="a_pp"/>
		      </lu> 
		      <lu>
			<clip pos="1" side="tl" part="lem"/>
			<clip pos="1" side="tl" part="a_prn"/>
			<clip pos="1" side="tl" part="tipus_prn"/>
			<clip pos="1" side="tl" part="pers"/>
			<clip pos="1" side="tl" part="gen"/>
			<clip pos="1" side="tl" part="nbr"/>		           
			<clip pos="3" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise> <!-- si no és separable: primer imprimim el verb, després mirem si cal imprimir el pronom (en verbs pronominals no cal si pronom conocorda amb pers del verb)-->

		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="2" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_pp"/>
		      <clip pos="3" side="tl" part="lemq"/>    
		    </lu> 
		  </chunk>
		</out>
		<choose><!-- ... i després enviem el prn (si cal)-->
		  <when>
		    <test>
		      <and>
			<equal>
			  <clip pos="3" side="sl" part="pron"/>
			  <lit-tag v="pron"/>
			</equal>
			<equal>
			  <clip pos="1" side="sl" part="pers"/>
			  <clip pos="2" side="sl" part="pers"/>
			</equal>
			<or>
			  <equal>
			    <clip pos="1" side="sl" part="nbr"/>
			    <clip pos="2" side="sl" part="nbr"/>
			  </equal>
			  <equal caseless="yes">
			    <clip pos="1" side="sl" part="lem"/>
			    <lit v="es"/><!--és 'sp' -->
			  </equal>
			</or>
		      </and>
		    </test>	
		    <call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		      <with-param pos="2"/>
		      <with-param pos="3"/>
		    </call-macro>
		  </when>
		  <otherwise>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/>
		      </equal>
		    </test>
		    <let>
		      <var n="lema"/>
		      <lit v="ref"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="ref"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema"/>
		      <lit v="pro"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="SN"/>
		    </let>
		  </otherwise>
		</choose>
		    <out>
		      <b pos="2"/>
		      <chunk namefrom="lema">
			<tags>
			  <tag><var n="nom_chunk"/></tag>
			  <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
			  <tag><clip pos="1" side="sl" part="pers"/></tag>
			  <tag><clip pos="1" side="tl" part="gen"/></tag>
			  <tag><clip pos="1" side="tl" part="nbr"/></tag>
			</tags>
			<lu>
			  <clip pos="1" side="tl" part="lem"/>
			  <clip pos="1" side="tl" part="a_prn"/>
			  <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
			  <clip pos="1" side="tl" part="pers"/>
			  <clip pos="1" side="tl" part="gen"/>
			  <clip pos="1" side="tl" part="nbr"/>
			</lu> 
		      </chunk>
		    </out>
		  </otherwise>
		</choose>  
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>



  <rule comment="pro + pro + HAVER + PP (me'ls han donat - have given them to me)">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="pro"/> 
	<pattern-item n="haver"/> 
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   	
	<call-macro n="tipus_verb">
	  <with-param pos="4"/>
	</call-macro>   
	<choose>
	  <when><!--Mira si és 'haver-hi' (n'hi ha hagut) -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>		     
		  <lit v="hi"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="4" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="4" side="tl" part="lem"/>
	      <get-case-from pos="4">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="4" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi_pp">
	      <with-param pos="3"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="lem"/>
		  <clip pos="4" side="tl" part="a_pp"/>
		</lu> 		  
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--Si no és 'haver-hi' -->

	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="4" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="4" side="tl" part="lem"/> 
	      <get-case-from pos="4">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="4" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<call-macro n="conj_verb1">
	  <with-param pos="3"/>
	</call-macro>
	<!-- aquí s'ha de mirar la separabilitat-->
	<choose>
	  <when>
	    <!-- si el verb és separable, posa el 2n clític entre el verb i la cua (me l'ha tret -> have taken it out)-->
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="sep"/>
		<lit-tag v="sep"/>	
	      </equal>
	    </test>
	    <choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="3" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		    <equal>
		      <clip pos="3" side="sl" part="temps"/>
		      <lit-tag v="fti"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <var n="lema_SV"/>
		  <lit v="aux_haver_pp_enc"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <var n="lema_SV"/>
		  <lit v="haver_pp_enc"/>
		</let>
	      </otherwise>
	    </choose>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		  <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>
		</lu>
		<b pos="1"/>
		<mlu>
		  <lu>
		    <clip pos="4" side="tl" part="lemh"/> 
		    <clip pos="4" side="tl" part="a_pp"/>
		  </lu> 
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="4" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise> <!-- si no és separable: primer imprimim el verb i després el pronom)-->
	    
	    <choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="3" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		    <equal>
		      <clip pos="3" side="sl" part="temps"/>
		      <lit-tag v="fti"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <var n="lema_SV"/>
		  <lit v="aux_haver_pp"/>
		</let>
	      </when>
	      <otherwise>
		<let>
		  <var n="lema_SV"/>
		  <lit v="haver_pp"/>
		</let>
	      </otherwise>
	    </choose>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_pp"/>
		  <clip pos="4" side="tl" part="lemq"/>    
		</lu> 
	      </chunk>
	      <b pos="1"/>
	      <chunk name="pro"> 
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="2" side="tl" part="lem"/>
		  <clip pos="2" side="tl" part="a_prn"/>
		  <clip pos="2" side="tl" part="tipus_prn" link-to="2"/>
		  <clip pos="2" side="tl" part="pers"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	  </otherwise>
	</choose>
	<choose><!--ara mirem el primer pronom  -->
	  <when>
	    <test>
	      <not><!--si no es dóna el cas que... --> 
		<or>
		  <and><!--o el verb és pronominal -->
		    <equal>
		      <clip pos="4" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and><!--o el primer enclític es tradueix per res (en/hi/[se]) -->
		  <equal>
		    <clip pos="1" side="tl" part="whole"/>
		    <lit v=""/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose><!--imprimeix 'to + prn' excepte si el 2n pronom tenia traducció buida i el verb no era separable -->
	      <when>
		<test>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="tl" part="whole"/>
			<lit v=""/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="4" side="tl" part="sep"/>
			  <lit-tag v="sep"/>	
			</equal>
		      </not>
		    </and>
		  </not>
		</test>
		<out>
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>	
		    <b pos="2"/>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	      <otherwise> <!--si el 2n pronom tenia trad buida i el verb no era separable, imprimeix el primer pronom directament sense la prep 'to' -->
		<out>
		  <chunk name="pro">
		    <tags>
		      <tag><lit-tag v="SN"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <b pos="2"/>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>
		<call-macro n="f_bcond"> 
		  <with-param pos="3"/>
	          <with-param pos="4"/>
		</call-macro>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <call-macro n="f_bcond"> 
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	    <call-macro n="f_bcond"> 
	      <with-param pos="3"/>
	      <with-param pos="4"/>
	    </call-macro>
	  </otherwise>	  
	</choose>
      </action>
    </rule>
    


	 

    <rule comment="REGLA: PROCLÍTIC VERB conjugat">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when><!--Mira si és 'haver-hi' -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>		     
		  <lit v="hi"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <get-case-from pos="2">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi">
	      <with-param pos="2"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>		  
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (el treu -> takes it out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="2" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <call-macro n="conj_verb1">
	      <with-param pos="2"/>
	    </call-macro>
	    <call-macro n="donar_per">
	      <with-param pos="2"/>
  	    </call-macro>	
	    <append n="lema_SV">
	      <lit v="_enc"/>
	    </append>
	    <out>
	    <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags>
		<mlu>
		  <lu>
		    <var n="verbfinal"/> 
		  </lu>	
		  <lu>
		    <clip pos="1" side="tl" part="lem"/>
		    <clip pos="1" side="tl" part="a_prn"/>
		    <clip pos="1" side="tl" part="tipus_prn"/>
		    <clip pos="1" side="tl" part="pers"/>
		    <clip pos="1" side="tl" part="gen"/>
		    <clip pos="1" side="tl" part="nbr"/>		           
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem el blanc -->
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	  </when>
	  <otherwise> <!--si no és un verb separable...-->
	    <call-macro n="conj_verb1">
	      <with-param pos="2"/>
	    </call-macro>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>		  
	    <choose><!--després d'imprimir el verb, mirem el proclític -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="2" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="2" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="2" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="1"/>
	          <with-param pos="2"/>
		</call-macro>
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/>
		      </equal>
		    </test>
		    <let>
		      <var n="lema"/>
		      <lit v="ref"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="ref"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema"/>
		      <lit v="pro"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="SN"/>
		    </let>
		  </otherwise>
		</choose>			
		<out>
		  <b pos="1"/>
		  <chunk namefrom="lema">
		    <tags>
		      <tag><var n="nom_chunk"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>
		    </lu>
		  </chunk>
		</out>		
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>

  <rule comment="REGLA: PROCL + PROCL + VERB conjugat">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="pro"/>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="conj_verb1">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="donar_per">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when><!--Mira si és 'haver-hi'(n'hi ha) -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>		     
		  <lit v="hi"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="3" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <get-case-from pos="3">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi">
	      <with-param pos="3"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="there"/>
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>		  
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <!-- si el verb és separable posa el 2n clític entre el verb i la cua (m'el treu -> takes it out...)-->
	    <test>
		<equal>
		  <clip pos="3" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
	    </test>
	    <append n="lema_SV">
	      <lit v="_enc"/>
	    </append>
	    <out>
	    <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		  <tag><var n="lemaverb"/></tag>
		</tags>
		<mlu>
		  <lu>
		    <var n="verbfinal"/> 
		  </lu>	
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem el blanc -->
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	  </when>
	  <otherwise> <!--si no és un verb separable...-->
	    
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
		  <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	      <b pos="1"/>
	      <chunk name="pro">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="gen"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="2" side="tl" part="lem"/>
		  <clip pos="2" side="tl" part="a_prn"/>
		  <clip pos="2" side="tl" part="tipus_prn" link-to="2"/>
		  <clip pos="2" side="tl" part="pers"/>
		  <clip pos="2" side="tl" part="gen"/>
		  <clip pos="2" side="tl" part="nbr"/>
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>
	</choose>
	<choose><!--ara mirem el primer pronom -->

	  <when>
	    <test>
	      <not><!--si no es dóna el cas que... --> 
		<or>
		  <and><!--o el verb és pronominal-->
		    <equal>
		      <clip pos="3" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and><!--o el primer enclític es tradueix per res (en/hi/[se]) -->
		  <equal>
		    <clip pos="1" side="tl" part="whole"/>
		    <lit v=""/>
		  </equal>
		</or>
	      </not>
	    </test>
	    <choose><!--imprimeix 'to + prn' excepte si el 2n pronom tenia traducció buida i el verb no era separable -->
	      <when>
		<test>
		  <not>
		    <and>
		      <equal>
			<clip pos="2" side="tl" part="whole"/>
			<lit v=""/>
		      </equal>
		      <not>
			<equal>
			  <clip pos="3" side="tl" part="sep"/>
			  <lit-tag v="sep"/>	
			</equal>
		      </not>
		    </and>
		  </not>
		</test>
		<out>
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="tl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>	
		    <b pos="2"/>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	      <otherwise> <!--si el 2n pronom tenia trad buida i el verb no era separable, imprimeix el primer pronom directament sense la prep 'to' -->
		<out>
		  <chunk name="pro">
		    <tags>
		      <tag><lit-tag v="SN"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <b pos="2"/>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <call-macro n="f_bcond"> 
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	  </otherwise>
	</choose>
      </action>
  </rule>


    <rule comment="VERB + ENCL (ajudar-me - help me) mireia vaig per aqui pingui">
      <pattern>
	<pattern-item n="verbnm_inf_ger"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="1"/>
	</call-macro>	
	<choose>      
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="verb_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><var n="lemaverb"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="verb_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="sl" part="temps"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags> 
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="sep"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/> 	           
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>   
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>	
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>	   
	</choose>
      </action>
    </rule>

    <rule comment="VERB + ENCL (ajuda'm - help me)">
      <pattern>
	<pattern-item n="verbnm_imp"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   	
	<call-macro n="tipus_verb">
	  <with-param pos="1"/>
	</call-macro>   
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>
	<choose>  
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="pron"/>
		  <lit-tag v="pron"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <clip pos="2" side="sl" part="pers"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <clip pos="2" side="sl" part="nbr"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="es"/><!--és 'sp' -->
		  </equal>
		</or>
	      </and>
	    </test>
	    <let><!--esborra el pronom quan coincideix en pers i nbr amb el verb pronominal -->
	      <clip pos="2" side="tl" part="whole"/>
	      <lit v=""/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="imp_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="sl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="1" side="tl" part="lemh"/>
		    <clip pos="1" side="tl" part="a_verb"/>
		    <clip pos="1" side="tl" part="sep"/>
		    <clip pos="1" side="tl" part="temps"/> 
		  </lu>  
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="1" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="imp_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="sl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags> 
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="sep"/>
		  <clip pos="1" side="tl" part="temps"/> 	           
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>   
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>	
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>	   
	</choose>
      </action>
    </rule>


    <rule comment="VERB + ENCL + ENCL (portar-me'ls - bring them to me)">
      <pattern>
	<pattern-item n="verbnm_inf_ger"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   	
	<call-macro n="tipus_verb">
	  <with-param pos="1"/>
	</call-macro>    
	<choose>
	  <when>
	    <test><!--si el segon enclític es tradueix per res (en/hi/[se]) -->
	      <equal>
		<clip pos="3" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/>
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>		 
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="lem"/>
		      <clip pos="2" side="tl" part="a_prn"/>
		      <clip pos="2" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="2" side="tl" part="pers"/>
		      <clip pos="2" side="tl" part="gen"/>
		      <clip pos="2" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>



    <rule comment="VERB + ENCL + ENCL (porta-me'ls - bring them to me)">
      <pattern>
	<pattern-item n="verbnm_imp"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    	
	<call-macro n="tipus_verb">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="1" side="tl" part="temps"/>
	  <lit-tag v="inf"/>
	</let>
	<choose>  
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="1" side="sl" part="pron"/>
		  <lit-tag v="pron"/>
		</equal>
		<equal>
		  <clip pos="1" side="sl" part="pers"/>
		  <clip pos="2" side="sl" part="pers"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="nbr"/>
		    <clip pos="2" side="sl" part="nbr"/>
		  </equal>
		  <equal caseless="yes">
		    <clip pos="2" side="sl" part="lem"/>
		    <lit v="es"/><!--és 'sp' -->
		  </equal>
		</or>
	      </and>
	    </test>
	    <let><!--esborra el pronom quan coincideix en pers i nbr amb el verb pronominal -->
	      <clip pos="2" side="tl" part="whole"/>
	      <lit v=""/>
	    </let>
	  </when>
	</choose>
	
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags> 
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps"/> 
		      </lu>  
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="1" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <mlu>
		      <lu>
			<clip pos="1" side="tl" part="lemh"/>
			<clip pos="1" side="tl" part="a_verb"/>
			<clip pos="1" side="tl" part="sep"/>
			<clip pos="1" side="tl" part="temps"/> 
		      </lu>  
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>		           
			<clip pos="1" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="imp_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="sl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="sep"/>
		      <clip pos="1" side="tl" part="temps"/>	           
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/> 
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="lem"/>
		      <clip pos="2" side="tl" part="a_prn"/>
		      <clip pos="2" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="2" side="tl" part="pers"/>
		      <clip pos="2" side="tl" part="gen"/>
		      <clip pos="2" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>



 


    <rule comment="VERBMOD + ENCL + INF (poder-ho fer - be able to do it)(no he fet res per a pronominals, difícil fer la concordança de persona en frases que no són de 3a persona ('es'): per poder-te enamorar...">
      <pattern>
	<pattern-item n="verbm"/> <!-- aquí tb separaria entre inf/ger i imperatiu, per poder fer enllaços coherents en 'temps' i poder deixar temps 'sl' en imperatiu i 'tl' en inf i ger.-->
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>               	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>   
	    <out>
	      <chunk name="mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>      
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>  
		<b pos="2"/>
		<mlu>
		  <lu>
		    <clip pos="3" side="tl" part="lemh"/>      
		    <clip pos="3" side="tl" part="a_verb"/>    
		    <clip pos="3" side="tl" part="sep"/>
		    <clip pos="3" side="tl" part="temps"/>
		  </lu>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>      
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>  
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="1" side="tl" part="temps"/></tag>
		  <tag><clip pos="1" side="sl" part="pers"/></tag>
		  <tag><clip pos="1" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lemh"/>
		  <clip pos="1" side="tl" part="a_verb"/>
		  <clip pos="1" side="tl" part="temps" link-to="3"/>      
		  <clip pos="1" side="tl" part="lemq"/>
		</lu>  
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>      
		  <clip pos="3" side="tl" part="a_verb"/>    
		  <clip pos="3" side="tl" part="sep"/>
		  <clip pos="3" side="tl" part="temps"/>      
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="whole"/>
		</lu> 
	      </chunk>
	    </out>  
	  </otherwise>
	</choose>  
      </action>
    </rule>

    <rule comment="VERBMOD + ENCL + ENCL + INF (poder-los-ho explicar -> be able to explain it to them)">
      <pattern>
	<pattern-item n="verbm"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   	
	<call-macro n="tipus_verb">
	  <with-param pos="4"/>
	</call-macro> 
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="4" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>  
		<out>
		  <chunk name="mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>      
			<clip pos="4" side="tl" part="a_verb"/>    
			<clip pos="4" side="tl" part="sep"/>
			<clip pos="4" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>     
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>      
		      <clip pos="4" side="tl" part="a_verb"/>    
		      <clip pos="4" side="tl" part="sep"/>
		      <clip pos="4" side="tl" part="temps"/>      
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="4" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    
		<out>
		  <chunk name="mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>      
			<clip pos="4" side="tl" part="a_verb"/>     
			<clip pos="4" side="tl" part="sep"/>
			<clip pos="4" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>     
			<clip pos="4" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="1" side="tl" part="temps"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lemh"/>
		      <clip pos="1" side="tl" part="a_verb"/>
		      <clip pos="1" side="tl" part="temps" link-to="3"/>
		      <clip pos="1" side="tl" part="lemq"/>
		    </lu>
		    <b pos="3"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>      
		      <clip pos="4" side="tl" part="a_verb"/>
		      <clip pos="4" side="tl" part="temps"/>    
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="2" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/> 
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="lem"/>
		      <clip pos="2" side="tl" part="a_prn"/>
		      <clip pos="2" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="2" side="tl" part="pers"/>
		      <clip pos="2" side="tl" part="gen"/>
		      <clip pos="2" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>



    <rule comment="REGLA: procl + verb modal + inf (em pot sorprendre -> can surprise me)">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="verbm"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>
	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when><!--mira si és 'haver-hi' (hi pot haver) -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="1" side="sl" part="lem"/>		     
		  <lit v="hi"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="3" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <get-case-from pos="3">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <append n="lema_SV">
	      <lit v="_haverhiinf"/>
	    </append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="there"/> 
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="verbfinal"/> 
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/> 
		</lu>		
	      </chunk>
	    </out>
	  </when>

	  <when><!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (el pot treure -> can take it out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="3" side="tl" part="sep"/>
		  <lit-tag v="sep"/>
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>   
	    <out>
	      <chunk name="mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>       
		  <clip pos="2" side="tl" part="lemq"/>  
		</lu>  
		<b pos="1"/>
		<mlu>
		  <lu>
		    <clip pos="3" side="tl" part="lemh"/>      
		    <clip pos="3" side="tl" part="a_verb"/>    
		    <clip pos="3" side="tl" part="sep"/>
		    <clip pos="3" side="tl" part="temps"/>
		  </lu>
		  <lu>
		    <clip pos="1" side="tl" part="lem"/>
		    <clip pos="1" side="tl" part="a_prn"/>
		    <clip pos="1" side="tl" part="tipus_prn"/>
		    <clip pos="1" side="tl" part="pers"/>
		    <clip pos="1" side="tl" part="gen"/>
		    <clip pos="1" side="tl" part="nbr"/>      
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>  
	    <call-macro n="f_bcond">
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	  </when>
	  <otherwise><!--si no és un verb separable...-->
	    <out>
	      <chunk name="mod_inf" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>  
		<b pos="1"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/>      
		  <clip pos="3" side="tl" part="a_verb"/>    
		  <clip pos="3" side="tl" part="sep"/>
		  <clip pos="3" side="tl" part="temps"/>      
		  <clip pos="3" side="tl" part="lemq"/>
		</lu>
	      </chunk>
	    </out> 


	    <choose><!--després d'imprimir el verb, mirem el proclític -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="2" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="2" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="2"/>
		  <with-param pos="3"/>
		</call-macro>
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/>
		      </equal>
		    </test>
		    <let>
		      <var n="lema"/>
		      <lit v="ref"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="ref"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema"/>
		      <lit v="pro"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="SN"/>
		    </let>
		  </otherwise>
		</choose>	
		<out>
		  <b pos="2"/>
		  <chunk namefrom="lema">
		    <tags>
		      <tag><var n="nom_chunk"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>		
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>




    <rule comment="VERBMOD + ENCL (per quan va davant desconegudes, perquè almenys no peti: poder-ho xxx - be able to it xxx)">
      <pattern>
	<pattern-item n="verbm"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>	  
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="mod_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="sl" part="pers"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>      
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>	  
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>


    <rule comment="VERBMOD + ENCL + ENCL (per quan va davant desconegudes, perquè almenys no peti: poder-los-ho xxx - be able to them it xxx" >
      <pattern>
	<pattern-item n="verbm"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="1" side="sl" part="temps"/>
		<lit-tag v="imp"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="temps"/>
	      <lit-tag v="inf"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/>	  
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="mod_enc_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><clip pos="1" side="sl" part="pers"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu> 
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>    
      </action>
    </rule>




    <rule comment="REGLA: PARTICIPI (perquè no enviï gènere ni nombre quan va sol (per tal que no doni error). Caldrà posar-lo tb en les regles d'adjectiu">
      <pattern>
	<pattern-item n="pp"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/> 
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags> 	
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_pp"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>



    <rule comment="PER + INF (per ajudar - to help (en general; cal estudiar quan hi va gerundi)">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   	
	<call-macro n="tipus_verb">
	  <with-param pos="2"/>
	</call-macro>     	
	<call-macro n="prep_inf">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk namefrom="tempsv">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>          
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>                  
	    </lu>  
	  </chunk>
	</out>   
      </action>
    </rule>






    <rule comment="PREP + HAVER + PP (per haver ajudat)">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="haverinf"/>
	<pattern-item n="pp"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>     	
<!--	<call-macro n="prep_inf">
	  <with-param pos="1"/>
	  <with-param pos="2"/>
	</call-macro>  -->
	<let>
	  <clip pos="2" side="tl" part="temps"/> 
	  <lit-tag v="ger"/><!--posem ger en tots els casos -->
	</let>	  
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="3" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/> 
	      <get-case-from pos="3">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="per_haver_pp" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/> 
		</lu>
		<b pos="1"/>		  
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/> 
		  <clip pos="2" side="tl" part="temps"/> 
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_pp"/>
		  <clip pos="3" side="tl" part="lemq"/>    
		</lu> 
	      </chunk>
	    </out>
      </action>
    </rule>



 <rule comment="REGLA: PARTICIPI + per (canvia 'for' per 'by' ja que es considera que generalment serà passiva.">
      <pattern>
	<pattern-item n="pp"/>
	<pattern-item n="per"/>
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="lem"/>
	  <get-case-from pos="2"> 
	    <lit v="by"/>
	  </get-case-from>
	</let>	  
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/> 
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pp" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags> 	
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_pp"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="pr">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out> 
      </action>
    </rule>




    <rule comment="PP + PER + INF (preparat per ajudar - prepared to help (perquè no entri per la regla anterior i digui 'prepared by')">
      <pattern>
	<pattern-item n="pp"/>
	<pattern-item n="prep"/>
	<pattern-item n="inf"/>
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>     	
	<call-macro n="prep_inf"><!---MG: en aquest cas, el 'de' potser hauria de traduir-se per 'of'? -->
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lem"/> 
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pp_pr_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SA"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="sl" part="nbr"/></tag>
	    </tags> 	
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_pp"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
	  <b pos="2"/>
	    <lu>          
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="sep"/>
	      <clip pos="3" side="tl" part="temps"/>
	      <clip pos="3" side="tl" part="lemq"/>                  
	    </lu>  
	  </chunk>
	</out>  
      </action>
    </rule>



    <rule comment="REGLA: VERB no conjugat (perquè posi bé la cua en multiparaules)">
      <pattern>
	<pattern-item n="inf"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     	
	<call-macro n="tipus_verb">
	  <with-param pos="1"/>
	</call-macro>  
	<out>
	  <chunk name="inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><var n="lemaverb"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="sep"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>

    <rule comment="REGLA: VERB no conjugat (perquè posi bé la cua en multiparaules)">
      <pattern>
	<pattern-item n="mod_inf"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     	
	<call-macro n="tipus_verb">
	  <with-param pos="1"/>
	</call-macro>  
	<out>
	  <chunk name="inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="tl" part="temps"/></tag>
	      <tag><var n="lemaverb"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="sep"/>
	      <clip pos="1" side="tl" part="temps" link-to="3"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>

 
    <rule comment="REGLA: VERB no conjugat (perquè posi bé la cua en multiparaules)">
      <pattern>
	<pattern-item n="ger"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lemh"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="1" side="tl" part="lemh"/>
	      <get-case-from pos="1">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="1" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="ger" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="1" side="sl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lemh"/> 
	      <clip pos="1" side="tl" part="a_verb"/>
	      <clip pos="1" side="tl" part="sep"/>
	      <clip pos="1" side="tl" part="temps"/>
	      <clip pos="1" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>




  <rule comment="REGLA: ESTAR + GER (estan estudiant)">
      <pattern>
	<pattern-item n="estar"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="conj_verb1">
	  <with-param pos="1"/>
	</call-macro> 	
	<call-macro n="tipus_verb">
	  <with-param pos="2"/>
	</call-macro>
	<append n="lema_SV">
	  <lit v="_ger"/>
	</append>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lemh"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lemh"/>
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk namefrom="lema_SV" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="1" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/> 
	    </lu>
	    <b pos="1"/>	    
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>






 <rule comment="REGLA: PROCLÍTIC ESTAR GER (els estan buscant) mireia falta els negatius pingui i amb dos proclítics">
      <pattern>
	<pattern-item n="pro"/>
	<pattern-item n="estar"/>
	<pattern-item n="ger"/>
      </pattern>
      <action>	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>		
	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro> 	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>
	<append n="lema_SV">
	  <lit v="_ger"/>
	</append>
	<choose>
	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (els estan traient -> are taking them out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="3" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <append n="lema_SV">
	      <lit v="_enc"/>
	    </append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
	      <tags>
		<tag><lit-tag v="SV"/></tag>
		<tag><clip pos="2" side="tl" part="a_verb"/></tag>
		<tag><var n="temps_chunk"/></tag>
		<tag><clip pos="2" side="tl" part="pers"/></tag>
		<tag><clip pos="2" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
	      </tags>
		  <lu>
		    <var n="verbfinal"/> 
		  </lu>	
		  <b pos="1"/>
		  <mlu>	    
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/> 
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="sep"/>
		      <clip pos="3" side="tl" part="temps"/>   
		    </lu>  
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>		           
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>
		  </mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem els blancs -->
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	  </when>
	  <otherwise><!--si no és un verb separable...-->
	    <out>
	      <chunk namefrom="lema_SV" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>
		</lu>
		<b pos="1"/>	    
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="sep"/>
		  <clip pos="3" side="tl" part="temps"/>
		  <clip pos="3" side="tl" part="lemq"/>    
		</lu>
	      </chunk>
	    </out>		  
	    <choose><!--després d'imprimir el verb, mirem el proclític -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="1" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="1" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="2"/>
	          <with-param pos="3"/>
		</call-macro>
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="1" side="sl" part="lem"/>
			<lit v="es"/>
		      </equal>
		    </test>
		    <let>
		      <var n="lema"/>
		      <lit v="ref"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="ref"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema"/>
		      <lit v="pro"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="SN"/>
		    </let>
		  </otherwise>
		</choose>	
		<out>
		  <b pos="2"/>
		  <chunk namefrom="lema">
		    <tags>
		      <tag><var n="nom_chunk"/></tag>
		      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="1" side="sl" part="pers"/></tag>
		      <tag><clip pos="1" side="tl" part="gen"/></tag>
		      <tag><clip pos="1" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/>
		      <clip pos="1" side="tl" part="a_prn"/>
		      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="1" side="tl" part="pers"/>
		      <clip pos="1" side="tl" part="gen"/>
		      <clip pos="1" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>		
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
 </rule>



    <!--**************************** SV precedits d'adverbi (negacions i altres) -->


<!--
    NO FUNCIONA LA COLOCACIÓ DEL 'NO' EN T3X PER ARA
    <rule comment="REGLA: ADV CALDRE (no calia - it was not necessary)">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="caldre"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test><!-*-hauria de fer també una llista d'adverbis que van entre aux i verb (It is always necessary) -*->
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="negatiu"/>
	      <lit-tag v="NEG"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	    </call-macro>
	  </when>
	  <otherwise>
	    <let>
	      <var n="negatiu"/>
	      <lit v=""/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>

	<choose>
	  <when><!-*-Si és en sg, envia el pronom subjecte 'it'. En plural caldria fer transformacions al t2x (calen 3 persones - 3 persons are necessary) -*->
	    <test>
	      <equal>
		<clip pos="2" side="sl" part="nbr"/>
		<lit-tag v="sg"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="prpers" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SN"/></tag>
		  <tag><lit-tag  v="subj"/></tag>
		  <tag><lit-tag  v="p3"/></tag>
		  <tag><lit-tag  v="nt"/></tag>
		  <tag><lit-tag  v="sg"/></tag>
		</tags>
		<lu>   
		  <lit v="prpers"/>  
		  <lit-tag v="prn"/>  
		  <lit-tag v="2"/> 
		  <lit-tag v="p3"/>
		  <lit-tag v="nt"/>
		  <lit-tag v="sg"/>
		</lu> 
	      </chunk>
	      <b/>
	    </out>  
	  </when>
	</choose>	  
	<choose>
	  <when>
	    <test>
	      <and>
		<or>
		  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="ifi"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="pii"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="pis"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="prs"/>
		  </equal>
		</or>		
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="temps"/>
	      <lit-tag v="past"/>
	    </let>
	    <out>
	      <chunk name="be_adj">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="negatiu"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="sep"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="pers"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="pri"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <out>
	      <chunk name="be_adj">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><var n="negatiu"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/> 
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="sep"/>
		  <clip pos="2" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="pers"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="2" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  
	  <otherwise><!-*-la resta de formes verbals no tenen pers i nbr en anglès -*->
	    <choose>
	      <when>
		<test> 
		    <equal>
		      <clip pos="2" side="sl" part="temps"/>
		      <lit-tag v="cni"/>
		    </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>
		<out>
		  <chunk name="aux_verb">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="negatiu"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="sl" part="temps"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <lit v="would"/>
		      <lit-tag v="vaux.inf"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/> 
		      <clip pos="2" side="tl" part="sep"/> 
		      <clip pos="2" side="tl" part="temps"/>
		      <clip pos="2" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>  
	      <when>
		<test>		 
		  <equal>
		    <clip pos="2" side="sl" part="temps"/>
		    <lit-tag v="fti"/>
		  </equal>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>		     
		  <lit-tag v="inf"/>
		</let>	
		<out>
		  <chunk name="aux_verb">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="negatiu"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="sl" part="temps"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <lit v="will"/>
		      <lit-tag v="vaux.inf"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/> 
		      <clip pos="2" side="tl" part="temps"/>
		      <clip pos="2" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="2" side="sl" part="temps"/> 
		      <lit-tag v="pri"/>
		    </equal>
		    <equal>
		      <clip pos="2" side="sl" part="temps"/>
		      <lit-tag v="prs"/>
		    </equal>
		    <equal>
		      <clip pos="2" side="sl" part="temps"/>
		      <lit-tag v="imp"/>
		    </equal>
		  </or>
		</test>
		<let>
		  <clip pos="2" side="tl" part="temps"/>		     
		  <lit-tag v="pres"/>
		</let>
		<out>
		  <chunk name="be_adj">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="negatiu"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="sl" part="temps"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/> 
		      <clip pos="2" side="tl" part="temps"/>
		      <clip pos="2" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	      <when>
		<test>
		  <or>
		    <equal>
		      <clip pos="2" side="sl" part="temps"/>
		      <lit-tag v="ifi"/>
		    </equal>
		    <equal>
		      <clip pos="2" side="sl" part="temps"/>
		      <lit-tag v="pii"/>
		    </equal>
		    <equal>
		      <clip pos="2" side="sl" part="temps"/>
		      <lit-tag v="pis"/>
		    </equal>
		  </or>
		</test>		   
		<let>
		  <clip pos="2" side="tl" part="temps"/>		     
		  <lit-tag v="past"/>
		</let>
		<out>
		  <chunk name="be_adj">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><var n="negatiu"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="sl" part="temps"/></tag>
		      <tag><clip pos="2" side="tl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/> 
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/> 
		      <clip pos="2" side="tl" part="temps"/>
		      <clip pos="2" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>
-->

    <rule comment="REGLA: ADV VERB conjugat (no volia)">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>    	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verb">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test><!--hauria de fer també una llista d'adverbis que van entre aux i verb (I've always liked it) -->
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>
	      
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>	
	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<call-macro n="donar_per">
	  <with-param pos="2"/>
	</call-macro>
	<out>
	  <chunk namefrom="lema_SV" case="caseSecondWord">
	    <tags>
	      <tag><var n="SVnegatiu"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/> 
	      <clip pos="2" side="tl" part="lemq"/> 
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>



    <rule comment="ADV ANAR + INF (no vaig venir)">
      <pattern>
	<pattern-item n="adv"/> 
	<pattern-item n="anar"/>
	<pattern-item n="inf"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  
	<let>
	  <clip pos="3" side="tl" part="temps"/>		     
	  <lit-tag v="past"/>
	</let>
	<choose>
	  <when>
	    <test><!--Si és verb 'ser' p1 o p3  té una conjugació pròpia en anglès -->
	      <and>
		<equal caseless="yes">
		  <clip pos="3" side="tl" part="lemh"/>
		  <lit v="be"/>
		</equal>
		<or>
		  <equal>
		    <clip pos="2" side="sl" part="pers"/>
		    <lit-tag v="p1"/>
		  </equal>
		  <equal>
		    <clip pos="2" side="sl" part="pers"/>
		    <lit-tag v="p3"/>
		  </equal>
		</or>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/>
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <out>
	      <chunk name="verbcj" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="temps"/>
		  <clip pos="2" side="tl" part="pers"/>
		  <clip pos="2" side="tl" part="nbr"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="verbcj" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="tl" part="pers"/></tag>
		  <tag><clip pos="2" side="tl" part="nbr"/></tag>
		</tags>
		<lu>          
		  <clip pos="3" side="tl" part="lemh"/>
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="sep"/>
		  <clip pos="3" side="tl" part="temps"/>
		  <clip pos="3" side="tl" part="lemq"/>                  
		</lu> 
	      </chunk>
	    </out>  
	  </otherwise>
	</choose>
	<call-macro n="f_bcond">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro> 
      </action>
    </rule>

   <rule comment="ADV pro ANAR + INF (no els vaig comprar - did not buy them)">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="pro"/> 
	<pattern-item n="anar"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 	
	<call-macro n="tipus_verb">
	  <with-param pos="4"/>
	</call-macro> 
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  
 
	<let>
	  <clip pos="4" side="tl" part="temps"/>		     
	  <lit-tag v="past"/>
	</let>
	<choose>    <!--Mira si és 'haver-hi' (hi vaig anar) -->
	  <when>
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>		     
		  <lit v="hi"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="4" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="4" side="tl" part="lem"/>
	      <get-case-from pos="4">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="4" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <out>
	      <chunk name="haverhi" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="4" side="tl" part="temps"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><lit-tag v="ND"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="2">
		    <lit v="there"/>
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <clip pos="4" side="tl" part="lem"/> 
		  <clip pos="4" side="tl" part="a_verb"/> 
		  <clip pos="4" side="tl" part="temps"/> 
		  <clip pos="3" side="tl" part="pers"/> 		 
		  <lit-tag v="5"/> 
		</lu>
	      </chunk>
	    </out>
	  </when>

	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (vaig treure'l -> took it out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="4" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="4" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <out>
	      <chunk name="verbcj_enc" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="4" side="tl" part="temps"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags> 
		<mlu>
		  <lu>
		    <clip pos="4" side="tl" part="lemh"/>
		    <clip pos="4" side="tl" part="a_verb"/>
		    <clip pos="4" side="tl" part="sep"/>
		    <clip pos="4" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="4" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem els blancs -->
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	    <call-macro n="f_bcond"> 
	      <with-param pos="3"/>
	      <with-param pos="4"/>
	    </call-macro>
	  </when>
	  <otherwise> <!--si no és un verb separable...-->
	    <choose>
	      <when>
		<test><!--mirem si és el verb "ser" -->
		  <and>
		    <equal caseless="yes">
		      <clip pos="4" side="tl" part="lemh"/>
		      <lit v="be"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="3" side="sl" part="pers"/>
			<lit-tag v="p1"/>
		      </equal>
		      <equal>
			<clip pos="3" side="sl" part="pers"/>
			<lit-tag v="p3"/>
		      </equal>
		    </or>
		    <equal>
		      <clip pos="3" side="sl" part="nbr"/>
		      <lit-tag v="sg"/>
		    </equal>
		  </and>
		</test>
		<out>
		  <chunk name="verbcj" case="caseSecondWord">
		    <tags>
		      <tag><var n="SVnegatiu"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="4" side="tl" part="temps"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		    </tags>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/> 
		      <clip pos="4" side="tl" part="a_verb"/>
		      <clip pos="4" side="tl" part="temps"/>
		      <clip pos="3" side="tl" part="pers"/>
		      <clip pos="3" side="tl" part="nbr"/>
		      <clip pos="4" side="tl" part="lemq"/> 
		    </lu>
		  </chunk>
		</out>
	      </when>
	      <otherwise> <!-- si no és el verb ser, l'enviem sense pers ni nbr-->
		<out>
		  <chunk name="verbcj" case="caseSecondWord">
		    <tags>
		      <tag><var n="SVnegatiu"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="4" side="tl" part="temps"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		    </tags>
		    <lu>          
		      <clip pos="4" side="tl" part="lemh"/>
		      <clip pos="4" side="tl" part="a_verb"/>
		      <clip pos="4" side="tl" part="sep"/>
		      <clip pos="4" side="tl" part="temps"/>
		      <clip pos="4" side="tl" part="lemq"/>                  
		    </lu> 
		  </chunk>
		</out>  
	      </otherwise>
	    </choose>
	    <call-macro n="f_bcond">
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>  
	    <choose><!--I ara que ja hem imprès el verb, mirem els proclítics -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="4" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="2" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="2" side="sl" part="lem"/>
			<lit v="es"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="3"/>
	          <with-param pos="4"/>
		</call-macro>
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="2" side="sl" part="lem"/>
			<lit v="es"/>
		      </equal>
		    </test>
		    <let>
		      <var n="lema"/>
		      <lit v="ref"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="ref"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema"/>
		      <lit v="pro"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="SN"/>
		    </let>
		  </otherwise>
		</choose>		
		<out>
		  <b pos="3"/>
		  <chunk namefrom="lema">
		    <tags>
		      <tag><var n="nom_chunk"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="2" side="tl" part="lem"/>
		      <clip pos="2" side="tl" part="a_prn"/>
		      <clip pos="2" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="2" side="tl" part="pers"/>
		      <clip pos="2" side="tl" part="gen"/>
		      <clip pos="2" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>  
	  </otherwise>
	</choose>
      </action>
    </rule>

    <rule comment="ADV HAVER + PP (no han vist - have  seen) ">
      <pattern>
	<pattern-item n="adv"/> 
	<pattern-item n="haver"/>
	<pattern-item n="pp"/> 
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="3" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/> 
	      <get-case-from pos="3">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_pp"/> 
	      <lit-tag v="vbmod.pp"/>
	    </let>
	  </when>
	</choose>

	<call-macro n="conj_verb1">
	  <with-param pos="2"/>
	</call-macro>
	<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
	  <when>
	    <test>
	      <or>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="cni"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="temps"/>
		  <lit-tag v="fti"/>
		</equal>
	      </or>
	    </test>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="aux_haver_pp"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="lema_SV"/>
	      <lit v="haver_pp"/>
	    </let>
	  </otherwise>
	</choose>	
	<out>
	  <chunk namefrom="lema_SV" case="caseSecondWord">
	    <tags>
	      <tag><var n="SVnegatiu"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><var n="temps_chunk"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <var n="verbfinal"/>
	    </lu>
	    <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_pp"/>
	      <clip pos="3" side="tl" part="lemq"/>    
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>




    <rule comment="ADV pro HAVER + PP (no els han vist - have not seen them)">
      <pattern>
	<pattern-item n="adv"/> 
	<pattern-item n="pro"/> 
	<pattern-item n="haver"/> 
	<pattern-item n="pp"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    	
	<call-macro n="tipus_verb">
	  <with-param pos="4"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
		<var n="caseSecondWord"/>
		<var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
		<var n="caseSecondWord"/>
		<case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose> 
	<choose>
	  <when><!--Mira si és 'haver-hi' -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>		     
		  <lit v="hi"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="4" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="4" side="tl" part="lem"/>
	      <get-case-from pos="4">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="4" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi_pp">
	      <with-param pos="3"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="2">
		    <lit v="there"/>
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>
		<b pos="3"/>
		<lu>
		  <clip pos="4" side="tl" part="lem"/>
		  <clip pos="4" side="tl" part="a_pp"/>
		</lu> 		  
	      </chunk>
	    </out>
	  </when>
	  <otherwise><!--Si no és 'haver-hi' -->
	    <choose>
	      <when>
		<test>
		  <equal caseless="yes">
		    <clip pos="4" side="sl" part="lem"/> 
		    <lit v="poder"/>
		  </equal>
		</test>
		<let>
		  <clip pos="4" side="tl" part="lem"/> 
		  <get-case-from pos="4">
		    <lit v="be able to"/>
		  </get-case-from>
		</let>
		<let>
		  <clip pos="4" side="tl" part="a_pp"/> 
		  <lit-tag v="vbmod.pp"/>
		</let>
	      </when>
	    </choose>
	    <call-macro n="conj_verb1">
	      <with-param pos="3"/>
	    </call-macro>

	    <!-- aquí s'ha de mirar la separabilitat-->
	    <choose>
	      <when>
		<!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (l'he tret -> have taken it out)-->
		<test>
		  <and>
		    <equal>
		      <clip pos="4" side="tl" part="sep"/>
		      <lit-tag v="sep"/>	
		    </equal>
		    <not>
		      <equal>
			<clip pos="4" side="sl" part="pron"/>
			<lit-tag v="pron"/>
		      </equal>
		    </not>
		  </and>
		</test>
		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp_enc"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp_enc"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseSecondWord">
		    <tags>
		      <tag><var n="SVnegatiu"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		      <tag><var n="lemaverb"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="2"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/> 
			<clip pos="4" side="tl" part="a_pp"/>
		      </lu> 
		      <lu>
			<clip pos="2" side="tl" part="lem"/>
			<clip pos="2" side="tl" part="a_prn"/>
			<clip pos="2" side="tl" part="tipus_prn"/>
			<clip pos="2" side="tl" part="pers"/>
			<clip pos="2" side="tl" part="gen"/>
			<clip pos="2" side="tl" part="nbr"/>		           
			<clip pos="4" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise> <!-- si no és separable: primer imprimim el verb, després mirem si cal imprimir el pronom (en verbs pronominals no cal si pronom conocorda amb pers del verb)-->

		<choose><!-- sobrescriu el nom de chunk assignat per la macro 'conj_verb1' -->
		  <when>
		    <test>
		      <or>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="cni"/>
			</equal>
			<equal>
			  <clip pos="3" side="sl" part="temps"/>
			  <lit-tag v="fti"/>
			</equal>
		      </or>
		    </test>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="aux_haver_pp"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema_SV"/>
		      <lit v="haver_pp"/>
		    </let>
		  </otherwise>
		</choose>
		<out>
		  <chunk namefrom="lema_SV" case="caseSecondWord">
		    <tags>
		      <tag><var n="SVnegatiu"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><var n="temps_chunk"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		      <tag><var n="lemaverb"/></tag>
		    </tags>
		    <lu>
		      <var n="verbfinal"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/> 
		      <clip pos="4" side="tl" part="a_pp"/>
		      <clip pos="4" side="tl" part="lemq"/>    
		    </lu> 
		  </chunk>
		</out>
		<!-- ... i després enviem el prn (si cal)-->
		<choose>
		  <when>
		    <test>
		      <and>
			<equal>
			  <clip pos="4" side="sl" part="pron"/>
			  <lit-tag v="pron"/>
			</equal>
			<equal>
			  <clip pos="2" side="sl" part="pers"/>
			  <clip pos="3" side="sl" part="pers"/>
			</equal>
			<or>
			  <equal>
			    <clip pos="2" side="sl" part="nbr"/>
			    <clip pos="3" side="sl" part="nbr"/>
			  </equal>
			  <equal caseless="yes">
			    <clip pos="2" side="sl" part="lem"/>
			    <lit v="es"/><!--és 'sp' -->
			  </equal>
			</or>
		      </and>
		    </test>	
		    <call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		      <with-param pos="3"/>
		      <with-param pos="4"/>
		    </call-macro>
		  </when>
		  <otherwise>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="2" side="sl" part="lem"/>
			<lit v="es"/>
		      </equal>
		    </test>
		    <let>
		      <var n="lema"/>
		      <lit v="ref"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="ref"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema"/>
		      <lit v="pro"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="SN"/>
		    </let>
		  </otherwise>
		</choose>
		    <out>
		      <b pos="3"/>
		      <chunk namefrom="lema">
			<tags>
			  <tag><var n="nom_chunk"/></tag>
			  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
			  <tag><clip pos="2" side="sl" part="pers"/></tag>
			  <tag><clip pos="2" side="tl" part="gen"/></tag>
			  <tag><clip pos="2" side="tl" part="nbr"/></tag>
			</tags>
			<lu>
			  <clip pos="2" side="tl" part="lem"/>
			  <clip pos="2" side="tl" part="a_prn"/>
			  <clip pos="2" side="tl" part="tipus_prn" link-to="2"/>
			  <clip pos="2" side="tl" part="pers"/>
			  <clip pos="2" side="tl" part="gen"/>
			  <clip pos="2" side="tl" part="nbr"/>
			</lu> 
		      </chunk>
		    </out>
		  </otherwise>
		</choose>  
	      </otherwise>
	    </choose>
	  </otherwise>
	</choose>
      </action>
    </rule>

    

    <rule comment="PER + NO + INF (per no oblidar - not to forget">
      <pattern>
	<pattern-item n="per_pera"/> 
	<pattern-item n="no"/> 
	<pattern-item n="inf"/> 
      </pattern>
      <action>       	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>    	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="adv.NEG"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="2">
		<lit v="not"/>
	      </get-case-from>
	      <clip pos="2" side="tl" part="tags"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="to">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="2">
		<lit v="to"/>
	      </get-case-from>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	  </chunk>
	  <b pos="2"/>
	  <chunk name="inf">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="3" side="sl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="sep"/>
	      <clip pos="3" side="tl" part="temps" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>               
	    </lu>  
	  </chunk>
	</out>   
      </action>
    </rule>

    <rule comment="REGLA: ADV PROCLÍTIC VERB conjugat (no el veig)">
      <pattern>
	<pattern-item n="adv"/>
	<pattern-item n="pro"/>
	<pattern-item n="verbcj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SVneg"/>
	    </let>
	    <call-macro n="f_bcond">
	      <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
	    <let>
	      <var n="caseSecondWord"/>
	      <var n="caseFirstWord"/>
	    </let>
	  </when>
	  <otherwise>
	    <let>
	      <var n="SVnegatiu"/>
	      <lit-tag v="SV"/>
	    </let>
	    <let>
	      <var n="caseSecondWord"/>
	      <case-of pos="2" side="sl" part="lem"/>
	    </let>
	    <out>
	      <chunk name="adv" case="caseFirstWord">
		<tags>
		  <tag><clip pos="1" side="tl" part="a_adv"/></tag>		
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="whole"/>
		</lu>		 
	      </chunk>
	      <b pos="1"/>
	    </out>
	  </otherwise>
	</choose>  

	<choose>
	  <when><!--Mira si és 'haver-hi' -->
	    <test>
	      <and>
		<equal caseless="yes">
		  <clip pos="2" side="sl" part="lem"/>		     
		  <lit v="hi"/>
		</equal>
		<equal caseless="yes">
		  <clip pos="3" side="sl" part="lem"/>		     
		  <lit v="haver"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="pers"/>		     
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="3" side="sl" part="nbr"/>		     
		  <lit-tag v="sg"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="3" side="tl" part="lem"/>
	      <get-case-from pos="3">
		<lit v="be"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="3" side="tl" part="a_verb"/>
	      <lit-tag v="vbser"/>
	    </let>
	    <call-macro n="conj_haverhi">
	      <with-param pos="3"/>
	    </call-macro> 
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><var n="pers_chunk"/></tag>
		  <tag><var n="nbr_chunk"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="2">
		    <lit v="there"/>
		  </get-case-from>
		  <lit-tag v="adv"/>
		</lu>
		<b pos="2"/>
		<lu>
		  <var n="verbfinal"/> 
		</lu>		  
	      </chunk>
	    </out>
	  </when>
	  <when>
	    <!-- si el verb és separable i no és pronominal, posa el clític entre el verb i la cua (el treu -> takes it out)-->
	    <test>
	      <and>
		<equal>
		  <clip pos="3" side="tl" part="sep"/>
		  <lit-tag v="sep"/>	
		</equal>
		<not>
		  <equal>
		    <clip pos="3" side="sl" part="pron"/>
		    <lit-tag v="pron"/>
		  </equal>
		</not>
	      </and>
	    </test>
	    <call-macro n="conj_verb1">
	      <with-param pos="3"/>
	    </call-macro>
	    <call-macro n="donar_per">
	      <with-param pos="3"/>
	    </call-macro>
	    <append n="lema_SV">
	      <lit v="_enc"/>
	    </append>
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags>
		<mlu>
		  <lu>
		    <var n="verbfinal"/>
		  </lu>
		  <lu>
		    <clip pos="2" side="tl" part="lem"/>
		    <clip pos="2" side="tl" part="a_prn"/>
		    <clip pos="2" side="tl" part="tipus_prn"/>
		    <clip pos="2" side="tl" part="pers"/>
		    <clip pos="2" side="tl" part="gen"/>
		    <clip pos="2" side="tl" part="nbr"/>		           
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu>
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond"> <!-- si cal, enviem el blanc -->
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	  </when>
	  <otherwise><!--Si no és separable...-->
	    <call-macro n="conj_verb1">
	      <with-param pos="3"/>
	    </call-macro>
	    <out>
	      <chunk namefrom="lema_SV" case="caseSecondWord">
		<tags>
		  <tag><var n="SVnegatiu"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><var n="temps_chunk"/></tag>
		  <tag><clip pos="3" side="tl" part="pers"/></tag>
		  <tag><clip pos="3" side="tl" part="nbr"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <var n="verbfinal"/>
		  <clip pos="3" side="tl" part="lemq"/> 
		</lu>
	      </chunk>
	    </out>
	    <choose><!--I ara que ja hem imprès el verb, mirem els proclítics (si no és haver-hi) -->
	      <when>
		<test>
		  <and>
		    <equal>
		      <clip pos="3" side="sl" part="pron"/>
		      <lit-tag v="pron"/>
		    </equal>
		    <equal>
		      <clip pos="2" side="sl" part="pers"/>
		      <clip pos="3" side="sl" part="pers"/>
		    </equal>
		    <or>
		      <equal>
			<clip pos="2" side="sl" part="nbr"/>
			<clip pos="3" side="sl" part="nbr"/>
		      </equal>
		      <equal caseless="yes">
			<clip pos="2" side="sl" part="lem"/>
			<lit v="es"/><!--és 'sp' -->
		      </equal>
		    </or>
		  </and>
		</test>	
		<call-macro n="f_bcond"><!--imprimeix el blanc si té info de format, el pronom no l'imprimeixis -->
		  <with-param pos="2"/>
	          <with-param pos="3"/>
		</call-macro>
	      </when>
	      <otherwise>
		<choose>
		  <when>
		    <test>
		      <equal caseless="yes">
			<clip pos="2" side="sl" part="lem"/>
			<lit v="es"/>
		      </equal>
		    </test>
		    <let>
		      <var n="lema"/>
		      <lit v="ref"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="ref"/>
		    </let>
		  </when>
		  <otherwise>
		    <let>
		      <var n="lema"/>
		      <lit v="pro"/>
		    </let>
		    <let>
		      <var n="nom_chunk"/>
		      <lit-tag v="SN"/>
		    </let>
		  </otherwise>
		</choose>	
		<out>
		  <b pos="2"/>
		  <chunk namefrom="lema">
		    <tags>
		      <tag><var n="nom_chunk"/></tag>
		      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="tl" part="gen"/></tag>
		      <tag><clip pos="2" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <clip pos="2" side="tl" part="lem"/>
		      <clip pos="2" side="tl" part="a_prn"/>
		      <clip pos="2" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="2" side="tl" part="pers"/>
		      <clip pos="2" side="tl" part="gen"/>
		      <clip pos="2" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>	
	      </otherwise>
	    </choose> 
	  </otherwise>
	</choose>
      </action>
    </rule>



    <rule comment="NO VERB + ENCL (no ajudar-me - not to help me) (posar-ho en gerundi en anglès?)">
      <pattern>
	<pattern-item n="no"/>
	<pattern-item n="verbnm_inf_ger"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>          	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verb">
	  <with-param pos="2"/>
	</call-macro>
	<choose>      
	  <when>
	    <test>
	      <equal>
		<clip pos="2" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="to_not_verb_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags> 
		<lu>
		  <get-case-from pos="1">
		    <lit v="not"/>
		  </get-case-from>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <get-case-from pos="2">
		    <lit v="to"/>
		  </get-case-from>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<mlu>
		  <lu>
		    <clip pos="2" side="tl" part="lemh"/>
		    <clip pos="2" side="tl" part="a_verb"/>
		    <clip pos="2" side="tl" part="sep"/>
		    <clip pos="2" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <clip pos="3" side="tl" part="a_prn"/>
		    <clip pos="3" side="tl" part="tipus_prn"/>
		    <clip pos="3" side="tl" part="pers"/>
		    <clip pos="3" side="tl" part="gen"/>
		    <clip pos="3" side="tl" part="nbr"/>		           
		    <clip pos="2" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="to_not_verb_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="sl" part="temps"/></tag>
	     <tag> <var n="lemaverb"/></tag>
		</tags> 
		<lu>
		  <get-case-from pos="1">
		    <lit v="not"/>
		  </get-case-from>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <get-case-from pos="2">
		  <lit v="to"/>
		  </get-case-from>
		  <lit-tag v="pr"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="sep"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/> 	           
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>   
		<b/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>	
		</lu> 
	      </chunk>
	    </out>
	  </otherwise>	   
	</choose>
      </action>
    </rule>



    <rule comment="NO VERB + ENCL + ENCL (no portar-me'ls - not to bring them to me)(en gerundi?)">
      <pattern>
	<pattern-item n="no"/> 
	<pattern-item n="verbnm_inf_ger"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="2"/>
	</call-macro>   
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="2" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="to_not_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <mlu>
		      <lu>
			<clip pos="2" side="tl" part="lemh"/>
			<clip pos="2" side="tl" part="a_verb"/>
			<clip pos="2" side="tl" part="sep"/>
			<clip pos="2" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>		           
			<clip pos="2" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="to_not_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="2" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="to_not_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <mlu>
		      <lu>
			<clip pos="2" side="tl" part="lemh"/>
			<clip pos="2" side="tl" part="a_verb"/>
			<clip pos="2" side="tl" part="sep"/>
			<clip pos="2" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="4" side="tl" part="lem"/>
			<clip pos="4" side="tl" part="a_prn"/>
			<clip pos="4" side="tl" part="tipus_prn"/>
			<clip pos="4" side="tl" part="pers"/>
			<clip pos="4" side="tl" part="gen"/>
			<clip pos="4" side="tl" part="nbr"/>		           
			<clip pos="2" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="to_not_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="sl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="2">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="sep"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>   
		    <b/>   
		    <lu>
		      <clip pos="4" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/>
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="3" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>		 
		    <lu>
		      <get-case-from pos="3">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="lem"/>
		      <clip pos="3" side="tl" part="a_prn"/>
		      <clip pos="3" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="3" side="tl" part="pers"/>
		      <clip pos="3" side="tl" part="gen"/>
		      <clip pos="3" side="tl" part="nbr"/>
		    </lu> 
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>



    <rule comment="NO + VERBMOD + ENCL + INF (no poder-ho fer - not being able to do it)(aquí ho he posat en gerundi, en els altres casos d'infinitiu negat no, revisar)">
      <pattern>
	<pattern-item n="no"/>
	<pattern-item n="verbm_inf_ger"/>
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>               	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro> 	
	<call-macro n="tipus_verb">
	  <with-param pos="4"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>   
	    <out>
	      <chunk name="no_mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="not"/>
		  </get-case-from>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>      
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>  
		<b pos="3"/>
		<mlu>
		  <lu>
		    <clip pos="4" side="tl" part="lemh"/>      
		    <clip pos="4" side="tl" part="a_verb"/>    
		    <clip pos="4" side="tl" part="sep"/>
		    <clip pos="4" side="tl" part="temps"/>
		  </lu>
		  <lu>
		    <clip pos="3" side="tl" part="lem"/>
		    <clip pos="3" side="tl" part="a_prn"/>
		    <clip pos="3" side="tl" part="tipus_prn"/>
		    <clip pos="3" side="tl" part="pers"/>
		    <clip pos="3" side="tl" part="gen"/>
		    <clip pos="3" side="tl" part="nbr"/>      
		    <clip pos="4" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>  
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="no_mod_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="2" side="tl" part="temps"/></tag>
		  <tag><clip pos="2" side="sl" part="pers"/></tag>
		  <tag><clip pos="2" side="sl" part="nbr"/></tag>
		</tags>
		<lu>
		  <get-case-from pos="1">
		    <lit v="not"/>
		  </get-case-from>
		  <clip pos="1" side="tl" part="tags"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <clip pos="2" side="tl" part="lemh"/>
		  <clip pos="2" side="tl" part="a_verb"/>
		  <clip pos="2" side="tl" part="temps" link-to="3"/>      
		  <clip pos="2" side="tl" part="lemq"/>
		</lu>  
		<b pos="3"/>
		<lu>
		  <clip pos="4" side="tl" part="lemh"/>      
		  <clip pos="4" side="tl" part="a_verb"/>    
		  <clip pos="4" side="tl" part="sep"/>
		  <clip pos="4" side="tl" part="temps"/>      
		  <clip pos="4" side="tl" part="lemq"/>
		</lu>
		<b/>
		<lu>
		  <clip pos="3" side="tl" part="whole"/>
		</lu> 
	      </chunk>
	    </out>  
	  </otherwise>
	</choose>  
      </action>
    </rule>

    <rule comment="NO + VERBMOD + ENCL + ENCL + INF (no poder-los-ho explicar -> not being able to explain it to them)">
      <pattern>
	<pattern-item n="no"/> 
	<pattern-item n="verbm_inf_ger"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="inf"/>
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verb">
	  <with-param pos="5"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<choose>
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="5" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>  
		<out>
		  <chunk name="no_mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <mlu>
		      <lu>
			<clip pos="5" side="tl" part="lemh"/>      
			<clip pos="5" side="tl" part="a_verb"/>   
			<clip pos="5" side="tl" part="sep"/>
			<clip pos="5" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="3" side="tl" part="lem"/>
			<clip pos="3" side="tl" part="a_prn"/>
			<clip pos="3" side="tl" part="tipus_prn"/>
			<clip pos="3" side="tl" part="pers"/>
			<clip pos="3" side="tl" part="gen"/>
			<clip pos="3" side="tl" part="nbr"/>     
			<clip pos="5" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="no_mod_inf_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <lu>
		      <clip pos="5" side="tl" part="lemh"/>      
		      <clip pos="5" side="tl" part="a_verb"/>     
		      <clip pos="5" side="tl" part="sep"/>
		      <clip pos="5" side="tl" part="temps"/>      
		      <clip pos="5" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="5" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    
		<out>
		  <chunk name="no_mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <mlu>
		      <lu>
			<clip pos="5" side="tl" part="lemh"/>      
			<clip pos="5" side="tl" part="a_verb"/>    
			<clip pos="5" side="tl" part="sep"/>
			<clip pos="5" side="tl" part="temps"/> 
		      </lu>
		      <lu>
			<clip pos="4" side="tl" part="lem"/>
			<clip pos="4" side="tl" part="a_prn"/>
			<clip pos="4" side="tl" part="tipus_prn"/>
			<clip pos="4" side="tl" part="pers"/>
			<clip pos="4" side="tl" part="gen"/>
			<clip pos="4" side="tl" part="nbr"/>     
			<clip pos="5" side="tl" part="lemq"/>
		      </lu>
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="no_mod_inf_enc_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="2" side="tl" part="temps"/></tag>
		      <tag><clip pos="2" side="sl" part="pers"/></tag>
		      <tag><clip pos="2" side="sl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="1">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="1" side="tl" part="tags"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="2" side="tl" part="lemh"/>
		      <clip pos="2" side="tl" part="a_verb"/>
		      <clip pos="2" side="tl" part="temps" link-to="3"/>
		      <clip pos="2" side="tl" part="lemq"/>
		    </lu>
		    <b pos="4"/>
		    <lu>
		      <clip pos="5" side="tl" part="lemh"/>      
		      <clip pos="5" side="tl" part="a_verb"/>    
		      <clip pos="5" side="tl" part="sep"/>
		      <clip pos="5" side="tl" part="temps"/>    
		      <clip pos="5" side="tl" part="lemq"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="4" side="tl" part="whole"/>
		    </lu>
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="3" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>
		  <b/> 
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="3" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="3" side="tl" part="pers"/></tag>
		      <tag><clip pos="3" side="tl" part="gen"/></tag>
		      <tag><clip pos="3" side="tl" part="nbr"/></tag>
		    </tags>
		    <lu>
		      <get-case-from pos="3">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="3" side="tl" part="lem"/>
		      <clip pos="3" side="tl" part="a_prn"/>
		      <clip pos="3" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="3" side="tl" part="pers"/>
		      <clip pos="3" side="tl" part="gen"/>
		      <clip pos="3" side="tl" part="nbr"/>
		    </lu>
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>


    <rule comment="NO + VERBMOD + ENCL (per quan va davant desconegudes, perquè almenys no peti: no poder-ho xxx - not being able to it xxx)">
      <pattern>
	<pattern-item n="no"/>
	<pattern-item n="verbm_inf_ger"/>
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>	  
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="no_mod_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><clip pos="2" side="sl" part="pers"/></tag>
	      <tag><clip pos="2" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="not"/>
	      </get-case-from>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>      
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>	  
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>


    <rule comment="NO + VERBMOD + ENCL + ENCL (per quan va davant desconegudes, perquè almenys no peti: no poder-los-ho xxx - not being able to them it xxx)">
      <pattern>
	<pattern-item n="no"/>
	<pattern-item n="verbm_inf_ger"/>
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>              	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/>
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/>	  
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>		     
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="no_mod_enc_enc_x" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	      <tag><clip pos="2" side="sl" part="pers"/></tag>
	      <tag><clip pos="2" side="sl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="not"/>
	      </get-case-from>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>
	    </lu>
	    <b/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu> 
	    <b/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/>
	    </lu> 
	  </chunk>
	</out>    
      </action>
    </rule>




    <rule comment="REGLA: NO + INF (no jugar - not playing)">
      <pattern>
	<pattern-item n="no"/>
	<pattern-item n="inf"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>  	
	<call-macro n="tipus_verb">
	  <with-param pos="2"/>
	</call-macro> 
	<let>
	  <clip pos="2" side="tl" part="temps"/>
	  <lit-tag v="ger"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lem"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lem"/> 
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/> 
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>

	<out>
	  <chunk name="no_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="not"/>
	      </get-case-from>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps" link-to="3"/>
	      <clip pos="2" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>

    <rule comment="REGLA: NO + GER (no fent - not doing)">
      <pattern>
	<pattern-item n="no"/> 
	<pattern-item n="ger"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>	
	<call-macro n="tipus_verb">
	  <with-param pos="2"/>
	</call-macro>
	<choose>
	  <when>
	    <test>
	      <equal caseless="yes">
		<clip pos="2" side="sl" part="lemh"/> 
		<lit v="poder"/>
	      </equal>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="lemh"/>
	      <get-case-from pos="2">
		<lit v="be able to"/>
	      </get-case-from>
	    </let>
	    <let>
	      <clip pos="2" side="tl" part="a_verb"/>
	      <lit-tag v="vbmod"/>
	    </let>
	  </when>
	</choose>	    
	<out>
	  <chunk name="no_ger" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="2" side="tl" part="temps"/></tag>
	    </tags>
	    <lu>
	      <get-case-from pos="1">
		<lit v="not"/>
	      </get-case-from>
	      <clip pos="1" side="tl" part="tags"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="lemh"/> 
	      <clip pos="2" side="tl" part="a_verb"/>
	      <clip pos="2" side="tl" part="sep"/>
	      <clip pos="2" side="tl" part="temps"/>
	      <clip pos="2" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>



 <rule comment="REGLA: tot i + inf - in spite of + ger ">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="i"/>
	<pattern-item n="inf"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>  
	<let>
	  <clip pos="1" side="tl" part="lem"/> 
	  <get-case-from pos="1">
	    <lit v="in spite of"/>
	  </get-case-from>
	</let>
	<let>
	  <clip pos="3" side="tl" part="temps"/> 
	  <lit-tag v="ger"/>
	</let>
	<out>
	  <chunk name="pr_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="3" side="tl" part="temps"/></tag>
	      <tag><var n="lemaverb"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit-tag v="pr"/>
	    </lu>
	    <b pos="1"/>	      
	    <lu>
	      <clip pos="3" side="tl" part="lemh"/> 
	      <clip pos="3" side="tl" part="a_verb"/>
	      <clip pos="3" side="tl" part="sep"/>
	      <clip pos="3" side="tl" part="temps" link-to="3"/>
	      <clip pos="3" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
	<call-macro n="f_bcond">
	  <with-param pos="2"/>
	  <with-param pos="3"/>
	</call-macro>
      </action>
    </rule>



 <rule comment="REGLA: tot i + inf + enc  - in spite of + ger + prnobj">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="i"/>
	<pattern-item n="inf"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>  
	<let>
	  <clip pos="1" side="tl" part="lem"/> 
	  <get-case-from pos="1">
	    <lit v="in spite of"/>
	  </get-case-from>
	</let>
	<let>
	  <clip pos="3" side="tl" part="temps"/> 
	  <lit-tag v="ger"/>
	</let>
	<choose>      
	  <when>
	    <test>
	      <equal>
		<clip pos="3" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="pr_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags> 
		<lu>
		  <clip pos="1" side="tl" part="lem"/> 
		  <lit-tag v="pr"/>
		</lu>
		<b pos="1"/>
		<mlu>
		  <lu>
		    <clip pos="3" side="tl" part="lemh"/>
		    <clip pos="3" side="tl" part="a_verb"/>
		    <clip pos="3" side="tl" part="sep"/>
		    <clip pos="3" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="4" side="tl" part="lem"/>
		    <clip pos="4" side="tl" part="a_prn"/>
		    <clip pos="4" side="tl" part="tipus_prn"/>
		    <clip pos="4" side="tl" part="pers"/>
		    <clip pos="4" side="tl" part="gen"/>
		    <clip pos="4" side="tl" part="nbr"/>		           
		    <clip pos="3" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="2"/>
	      <with-param pos="3"/>
	    </call-macro>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="pr_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="3" side="tl" part="temps"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lem"/> 
		  <lit-tag v="pr"/>
		</lu>
		<b pos="1"/>	      
		<lu>
		  <clip pos="3" side="tl" part="lemh"/> 
		  <clip pos="3" side="tl" part="a_verb"/>
		  <clip pos="3" side="tl" part="sep"/>
		  <clip pos="3" side="tl" part="temps" link-to="3"/>
		  <clip pos="3" side="tl" part="lemq"/>    
		</lu> 
		<b pos="2"/> 
		<lu>
		  <clip pos="4" side="tl" part="whole"/>	
		</lu> 
	      </chunk>
	    </out>  
	  </otherwise>
	</choose>
      </action>
    </rule>



    <rule comment="tot i + inf + enc + enc  - in spite of + ger + prnobj to prnobj)">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="i"/>
	<pattern-item n="inf"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   	
	<call-macro n="tipus_verb">
	  <with-param pos="3"/>
	</call-macro>    
	<let>
	  <clip pos="1" side="tl" part="lem"/> 
	  <get-case-from pos="1">
	    <lit v="in spite of"/>
	  </get-case-from>
	</let>
	<let>
	  <clip pos="3" side="tl" part="temps"/> 
	  <lit-tag v="ger"/>
	</let> 
	<choose>
	  <when>
	    <test><!--si el segon enclític es tradueix per res (en/hi/[se]) -->
	      <equal>
		<clip pos="5" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="3" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="pr_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="3" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lem"/> 
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="1"/>
		    <mlu>
		      <lu>
			<clip pos="3" side="tl" part="lemh"/>
			<clip pos="3" side="tl" part="a_verb"/>
			<clip pos="3" side="tl" part="sep"/>
			<clip pos="3" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="4" side="tl" part="lem"/>
			<clip pos="4" side="tl" part="a_prn"/>
			<clip pos="4" side="tl" part="tipus_prn"/>
			<clip pos="4" side="tl" part="pers"/>
			<clip pos="4" side="tl" part="gen"/>
			<clip pos="4" side="tl" part="nbr"/>		           
			<clip pos="3" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
		<call-macro n="f_bcond">
		  <with-param pos="2"/>
		  <with-param pos="3"/>
		</call-macro>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="pr_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="3" side="tl" part="temps"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/> 
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="1"/> 
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="sep"/>
		      <clip pos="3" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu> 
		    <b pos="2"/>  
		    <lu>
		      <clip pos="4" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="3" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="pr_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="3" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lem"/> 
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="1"/>
		    <mlu>
		      <lu>
			<clip pos="3" side="tl" part="lemh"/>
			<clip pos="3" side="tl" part="a_verb"/>
			<clip pos="3" side="tl" part="sep"/>
			<clip pos="3" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="5" side="tl" part="lem"/>
			<clip pos="5" side="tl" part="a_prn"/>
			<clip pos="5" side="tl" part="tipus_prn"/>
			<clip pos="5" side="tl" part="pers"/>
			<clip pos="5" side="tl" part="gen"/>
			<clip pos="5" side="tl" part="nbr"/>		           
			<clip pos="3" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="pr_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="3" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="3" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lem"/> 
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <clip pos="3" side="tl" part="lemh"/>
		      <clip pos="3" side="tl" part="a_verb"/>
		      <clip pos="3" side="tl" part="sep"/>
		      <clip pos="3" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="3" side="tl" part="lemq"/>
		    </lu>  
		    <b/> 
		    <lu>
		      <clip pos="5" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="4" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>		  
		  <b pos="2"/>
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="4" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="4" side="tl" part="pers"/></tag>
		      <tag><clip pos="4" side="tl" part="gen"/></tag>
		      <tag><clip pos="4" side="tl" part="nbr"/></tag>
		    </tags>		 
		    <lu>
		      <get-case-from pos="4">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="4" side="tl" part="lem"/>
		      <clip pos="4" side="tl" part="a_prn"/>
		      <clip pos="4" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="4" side="tl" part="pers"/>
		      <clip pos="4" side="tl" part="gen"/>
		      <clip pos="4" side="tl" part="nbr"/>
		    </lu>
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>


 <rule comment="REGLA: tot i + no + inf - in spite of + not + ger ">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="i"/>
	<pattern-item n="no"/>
	<pattern-item n="inf"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     	
	<call-macro n="tipus_verb">
	  <with-param pos="4"/>
	</call-macro>  
	<let>
	  <clip pos="1" side="tl" part="lem"/> 
	  <get-case-from pos="1">
	    <lit v="in spite of"/>
	  </get-case-from>
	</let>
	<let>
	  <clip pos="4" side="tl" part="temps"/> 
	  <lit-tag v="ger"/>
	</let>
	<out>
	  <chunk name="pr_no_inf" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SV"/></tag>
	      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
	      <tag><clip pos="4" side="tl" part="temps"/></tag>
	      <tag><var n="lemaverb"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <lit-tag v="pr"/>
	    </lu>
	    <b pos="1"/>
	    <lu>
	      <get-case-from pos="3">
		<lit v="not"/>
	      </get-case-from>
	      <clip pos="3" side="tl" part="tags"/>
	    </lu>
	    <b pos="2"/>	      
	    <lu>
	      <clip pos="4" side="tl" part="lemh"/> 
	      <clip pos="4" side="tl" part="a_verb"/>
	      <clip pos="4" side="tl" part="sep"/>
	      <clip pos="4" side="tl" part="temps" link-to="3"/>
	      <clip pos="4" side="tl" part="lemq"/>    
	    </lu>
	  </chunk>
	</out>  
	<call-macro n="f_bcond">
	  <with-param pos="3"/>
	  <with-param pos="4"/>
	</call-macro>
      </action>
    </rule>



 <rule comment="REGLA: tot i + no + inf + enc  - in spite of + not + ger + prnobj">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="i"/>
	<pattern-item n="no"/>
	<pattern-item n="inf"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>     	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>     	
	<call-macro n="tipus_verb">
	  <with-param pos="4"/>
	</call-macro>  
	<let>
	  <clip pos="1" side="tl" part="lem"/> 
	  <get-case-from pos="1">
	    <lit v="in spite of"/>
	  </get-case-from>
	</let>
	<let>
	  <clip pos="4" side="tl" part="temps"/> 
	  <lit-tag v="ger"/>
	</let>
	<choose>      
	  <when>
	    <test>
	      <equal>
		<clip pos="4" side="tl" part="sep"/>
		<lit-tag v="sep"/>
	      </equal>
	    </test>
	    <out>
	      <chunk name="pr_no_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="4" side="tl" part="temps"/></tag>
	      <tag><var n="lemaverb"/></tag>
		</tags> 
		<lu>
		  <clip pos="1" side="tl" part="lem"/> 
		  <lit-tag v="pr"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <get-case-from pos="3">
		    <lit v="not"/>
		  </get-case-from>
		  <clip pos="3" side="tl" part="tags"/>
		</lu>
		<b pos="2"/>
		<mlu>
		  <lu>
		    <clip pos="4" side="tl" part="lemh"/>
		    <clip pos="4" side="tl" part="a_verb"/>
		    <clip pos="4" side="tl" part="sep"/>
		    <clip pos="4" side="tl" part="temps" link-to="3"/> 
		  </lu>  
		  <lu>
		    <clip pos="5" side="tl" part="lem"/>
		    <clip pos="5" side="tl" part="a_prn"/>
		    <clip pos="5" side="tl" part="tipus_prn"/>
		    <clip pos="5" side="tl" part="pers"/>
		    <clip pos="5" side="tl" part="gen"/>
		    <clip pos="5" side="tl" part="nbr"/>		           
		    <clip pos="4" side="tl" part="lemq"/>
		  </lu> 
		</mlu>
	      </chunk>
	    </out>
	    <call-macro n="f_bcond">
	      <with-param pos="3"/>
	      <with-param pos="4"/>
	    </call-macro>
	  </when>
	  <otherwise>
	    <out>
	      <chunk name="pr_no_inf_enc" case="caseFirstWord">
		<tags>
		  <tag><lit-tag v="SV"/></tag>
		  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		  <tag><clip pos="4" side="tl" part="temps"/></tag>
		  <tag><var n="lemaverb"/></tag>
		</tags>
		<lu>
		  <clip pos="1" side="tl" part="lem"/> 
		  <lit-tag v="pr"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <get-case-from pos="3">
		    <lit v="not"/>
		  </get-case-from>
		  <clip pos="3" side="tl" part="tags"/>
		</lu>
		<b pos="2"/>	      
		<lu>
		  <clip pos="4" side="tl" part="lemh"/> 
		  <clip pos="4" side="tl" part="a_verb"/>
		  <clip pos="4" side="tl" part="sep"/>
		  <clip pos="4" side="tl" part="temps" link-to="3"/>
		  <clip pos="4" side="tl" part="lemq"/>    
		</lu> 
		<b pos="3"/> 
		<lu>
		  <clip pos="5" side="tl" part="whole"/>	
		</lu> 
	      </chunk>
	    </out>  
	  </otherwise>
	</choose>
      </action>
    </rule>



    <rule comment="tot i + inf + no + enc + enc  - in spite of + not +  ger + prnobj to prnobj)">
      <pattern>
	<pattern-item n="tot"/>
	<pattern-item n="i"/>
	<pattern-item n="no"/>
	<pattern-item n="inf"/> 
	<pattern-item n="enc"/> 
	<pattern-item n="enc"/> 
      </pattern>
      <action>           	
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>   	
	<call-macro n="tipus_verb">
	  <with-param pos="4"/>
	</call-macro>    
	<let>
	  <clip pos="1" side="tl" part="lem"/> 
	  <get-case-from pos="1">
	    <lit v="in spite of"/>
	  </get-case-from>
	</let>
	<let>
	  <clip pos="4" side="tl" part="temps"/> 
	  <lit-tag v="ger"/>
	</let> 
	<choose>
	  <when>
	    <test><!--si el segon enclític es tradueix per res (en/hi/[se]) -->
	      <equal>
		<clip pos="6" side="tl" part="whole"/>
		<lit v=""/>
	      </equal>
	    </test>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="4" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="pr_no_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="4" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lem"/> 
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="3">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="3" side="tl" part="tags"/>
		    </lu>
		    <b pos="2"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>
			<clip pos="4" side="tl" part="a_verb"/>
			<clip pos="4" side="tl" part="sep"/>
			<clip pos="4" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="5" side="tl" part="lem"/>
			<clip pos="5" side="tl" part="a_prn"/>
			<clip pos="5" side="tl" part="tipus_prn"/>
			<clip pos="5" side="tl" part="pers"/>
			<clip pos="5" side="tl" part="gen"/>
			<clip pos="5" side="tl" part="nbr"/>		           
			<clip pos="4" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
		<call-macro n="f_bcond">
		  <with-param pos="3"/>
	          <with-param pos="4"/>
		</call-macro>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="pr_no_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="4" side="tl" part="temps"/></tag>
		    </tags>
		    <lu>
		      <clip pos="1" side="tl" part="lem"/> 
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="3">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="3" side="tl" part="tags"/>
		    </lu>
		    <b pos="2"/> 
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>
		      <clip pos="4" side="tl" part="a_verb"/>
		      <clip pos="4" side="tl" part="sep"/>
		      <clip pos="4" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu> 
		    <b pos="3"/>  
		    <lu>
		      <clip pos="5" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	  </when>
	  <otherwise>
	    <choose>
	      <when>
		<test>
		  <equal>
		    <clip pos="4" side="tl" part="sep"/>
		    <lit-tag v="sep"/>
		  </equal>
		</test>    	
		<out>
		  <chunk name="pr_no_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="4" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lem"/> 
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="3">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="3" side="tl" part="tags"/>
		    </lu>
		    <b pos="2"/>
		    <mlu>
		      <lu>
			<clip pos="4" side="tl" part="lemh"/>
			<clip pos="4" side="tl" part="a_verb"/>
			<clip pos="4" side="tl" part="sep"/>
			<clip pos="4" side="tl" part="temps" link-to="3"/> 
		      </lu>  
		      <lu>
			<clip pos="6" side="tl" part="lem"/>
			<clip pos="6" side="tl" part="a_prn"/>
			<clip pos="6" side="tl" part="tipus_prn"/>
			<clip pos="6" side="tl" part="pers"/>
			<clip pos="6" side="tl" part="gen"/>
			<clip pos="6" side="tl" part="nbr"/>		           
			<clip pos="4" side="tl" part="lemq"/>
		      </lu> 
		    </mlu>
		  </chunk>
		</out>
	      </when>
	      <otherwise>
		<out>
		  <chunk name="pr_no_verb_enc" case="caseFirstWord">
		    <tags>
		      <tag><lit-tag v="SV"/></tag>
		      <tag><clip pos="4" side="tl" part="a_verb"/></tag>
		      <tag><clip pos="4" side="tl" part="temps"/></tag>
		    </tags> 
		    <lu>
		      <clip pos="1" side="tl" part="lem"/> 
		      <lit-tag v="pr"/>
		    </lu>
		    <b pos="1"/>
		    <lu>
		      <get-case-from pos="3">
			<lit v="not"/>
		      </get-case-from>
		      <clip pos="3" side="tl" part="tags"/>
		    </lu>
		    <b pos="2"/>
		    <lu>
		      <clip pos="4" side="tl" part="lemh"/>
		      <clip pos="4" side="tl" part="a_verb"/>
		      <clip pos="4" side="tl" part="sep"/>
		      <clip pos="4" side="tl" part="temps" link-to="3"/>	           
		      <clip pos="4" side="tl" part="lemq"/>
		    </lu>  
		    <b/> 
		    <lu>
		      <clip pos="6" side="tl" part="whole"/>
		    </lu> 
		  </chunk>
		</out>
	      </otherwise>
	    </choose>
	    <choose>
	      <when>
		<test>
		  <not>
		    <equal>
		      <clip pos="5" side="tl" part="whole"/>
		      <lit v=""/>
		    </equal>
		  </not>
		</test>
		<out>		  
		  <b pos="3"/>
		  <chunk name="to_prn">
		    <tags>
		      <tag><lit-tag v="SP"/></tag>
		      <tag><clip pos="5" side="tl" part="tipus_prn"/></tag>
		      <tag><clip pos="5" side="tl" part="pers"/></tag>
		      <tag><clip pos="5" side="tl" part="gen"/></tag>
		      <tag><clip pos="5" side="tl" part="nbr"/></tag>
		    </tags>		 
		    <lu>
		      <get-case-from pos="5">
			<lit v="to"/>
		      </get-case-from>
		      <lit-tag v="pr"/>
		    </lu>
		    <b/>
		    <lu>
		      <clip pos="5" side="tl" part="lem"/>
		      <clip pos="5" side="tl" part="a_prn"/>
		      <clip pos="5" side="tl" part="tipus_prn" link-to="2"/>
		      <clip pos="5" side="tl" part="pers"/>
		      <clip pos="5" side="tl" part="gen"/>
		      <clip pos="5" side="tl" part="nbr"/>
		    </lu>
		  </chunk>
		</out>
	      </when>
	    </choose>
	  </otherwise>
	</choose> 
      </action>
    </rule>



    <!--************************************ ALTRES ************************************************ -->

    <rule comment="fins el DIGITS de MESO (fins el 30 d'agost → until August 30th (en_US))">
      <pattern>
	<pattern-item n="fins"/>
	<pattern-item n="el"/>
	<pattern-item n="digits"/>
	<pattern-item n="de"/>
	<pattern-item n="mesos"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="fins_el_digits_de_meso" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>	
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit-tag v="num.ord"/>
	    </lu>
	  </chunk>
	</out>  
        <call-macro n="f_bcond">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_bcond">
          <with-param pos="4"/>
          <with-param pos="5"/>
        </call-macro>
      </action>
    </rule>
<!-- above is en_US, en_GB:
    <rule comment="fins el DIGITS de MESO (fins el 30 d'agost → until the 30th of August)">
      <pattern>
	<pattern-item n="fins"/>
	<pattern-item n="el"/>
	<pattern-item n="digits"/>
	<pattern-item n="de"/>
	<pattern-item n="mesos"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="fins_el_digits_de_meso" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>	
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="2" side="tl" part="whole"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="3" side="tl" part="lem"/>
	      <lit-tag v="num.ord"/>
	    </lu>
            <b pos="3"/>
	    <lu>
	      <clip pos="4" side="tl" part="whole"/>
	    </lu>
            <b pos="4"/>
	    <lu>
	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>
-->
    <rule comment="NUM de MESO de NUM (23 de juliol de 2010 → July 23, 2010">
      <pattern>
	<pattern-item n="num"/>
	<pattern-item n="de"/>
	<pattern-item n="mesos"/>
	<pattern-item n="de"/>
	<pattern-item n="num"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="num_de_meso_de_num" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>	
	    </tags>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	    <lu>
	      <lit v=","/>
	      <lit-tag v="cm"/>
	    </lu>
            <b pos="2"/>
	    <lu>
	      <clip pos="5" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>  
        <call-macro n="f_bcond">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_bcond">
          <with-param pos="4"/>
          <with-param pos="5"/>
        </call-macro>
      </action>
    </rule>

    <rule comment="a + DET + MESO ( al juliol → in July">
      <pattern>
	<pattern-item n="a"/>
	<pattern-item n="det"/>
	<pattern-item n="mesos"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="in_meso" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_prep"/></tag>	
	    </tags>

	    <lu>
	      <lit v="in"/>
	      <lit-tag v="pr"/>
	    </lu>
            <b pos="1"/>
	    <lu>
	      <clip pos="3" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>  
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
      </action>
    </rule>
    <rule comment="ADV">
      <pattern>
	<pattern-item n="adv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<choose>
	  <when>
	    <test><!--hauria de fer també una llista d'adverbis que van entre aux i verb (I've always liked it) -->
	      <equal caseless="yes">
		<clip pos="1" side="sl" part="lem"/>
		<lit v="no"/>
	      </equal>
	    </test>
	    <let>
	      <var n="paraula1"/>
	      <clip pos="1" side="tl" part="whole"/>
	    </let>
	    <append n="paraula1">
	      <lit-tag v="NEG"/>
	    </append>
	    <let>
	      <clip pos="1" side="tl" part="whole"/>
	      <var n="paraula1"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>
	      <tag><clip pos="1" side="tl" part="neg"/></tag>		
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_adv"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>

<rule comment="ADV ITG">
      <pattern>
	<pattern-item n="advitg"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="adv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>	
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>  
      </action>
    </rule>


<rule comment="PRONOM tònic/interrogatiu/possessiu (no pronoms personals)"> 
      <pattern>
	<pattern-item n="tn_itg_pos"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="prn" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="lem"/> 
	      <clip pos="1" side="tl" part="a_prn"/>
	      <clip pos="1" side="tl" part="tipus_prn"/>
	      <clip pos="1" side="tl" part="gen" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr" link-to="4"/>
	    </lu> 
	  </chunk>
	</out>
      </action>
    </rule>



    <rule comment="PRN personal">
      <pattern>
	<pattern-item n="prpers"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="prpers" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="1" side="tl" part="pers"/></tag>
	      <tag><clip pos="1" side="tl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="lem"/>  
	      <clip pos="1" side="tl" part="a_prn"/>  
	      <clip pos="1" side="tl" part="tipus_prn" link-to="2"/> 
	      <clip pos="1" side="tl" part="pers"/>
	      <clip pos="1" side="tl" part="gen"/>
	      <clip pos="1" side="tl" part="nbr"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>
    
  <rule comment="PREP PRN personal (amb ell = with him (prn obj))">
      <pattern>
	<pattern-item n="prep"/>
	<pattern-item n="prpers"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<let>
	  <clip pos="2" side="tl" part="tipus_prn"/> 
	  <lit-tag v="obj"/>
	</let>
	<choose>
	  <when>
	    <test>
	      <and>
		<equal>
		  <clip pos="2" side="sl" part="pers"/> 
		  <lit-tag v="p3"/>
		</equal>
		<equal>
		  <clip pos="2" side="sl" part="nbr"/> 
		  <lit-tag v="pl"/>
		</equal>
	      </and>
	    </test>
	    <let>
	      <clip pos="2" side="tl" part="gen"/>
	      <lit-tag v="mf"/><!--ells/elles = them (mf)-->
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	  <b pos="1"/>
	  <chunk name="prpers">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
	      <tag><clip pos="2" side="tl" part="pers"/></tag>
	      <tag><clip pos="2" side="tl" part="gen"/></tag>
	      <tag><clip pos="2" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="2" side="tl" part="lem"/>  
	      <clip pos="2" side="tl" part="a_prn"/>  
	      <clip pos="2" side="tl" part="tipus_prn" link-to="2"/> 
	      <clip pos="2" side="tl" part="pers"/>
	      <clip pos="2" side="tl" part="gen"/>
	      <clip pos="2" side="tl" part="nbr"/>
	    </lu> 
	  </chunk>
	</out>  
      </action>
    </rule>
    
 <rule comment="CNJ">
      <pattern>
	<pattern-item n="cnj"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="lem"/>
                <lit v="que"/>
              </equal>
            </test>
	    <out>
	      <chunk name="que" case="caseFirstWord">
	        <tags>
	          <tag><clip pos="1" side="tl" part="tags"/></tag>		
	        </tags>
	        <lu>
	          <clip pos="1" side="tl" part="whole"/>
	        </lu>
	      </chunk>
	    </out>
          </when>
          <otherwise>
	    <out>
	      <chunk name="cnj" case="caseFirstWord">
	        <tags>
	          <tag><clip pos="1" side="tl" part="tags"/></tag>		
	        </tags>
	        <lu>
	          <clip pos="1" side="tl" part="whole"/>
	        </lu>
	      </chunk>
	    </out>
          </otherwise>
        </choose>
      </action>
    </rule>

 <rule comment="de">
      <pattern>
	<pattern-item n="de"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="de" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


    <rule comment="PREP">
      <pattern>
	<pattern-item n="prep"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="pr" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="PREP"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


  <rule comment="REL">
      <pattern>
	<pattern-item n="rel"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="rel" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_rel"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


  <rule comment="PREADV">
      <pattern>
	<pattern-item n="preadv"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="preadv" case="caseFirstWord">
	    <tags>
	      <tag><clip pos="1" side="tl" part="a_adv"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>

<rule comment="REGLA: NP cognom">
      <pattern>
	<pattern-item n="cog"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="cog" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>



<rule comment="REGLA: NP altres">
      <pattern>
	<pattern-item n="al"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="al" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>


<rule comment="REGLA: NUM">
      <pattern>
	<pattern-item n="num"/>
      </pattern>
      <action>
	<call-macro n="firstWord">
	  <with-param pos="1"/>
	</call-macro>
	<out>
	  <chunk name="num" case="caseFirstWord">
	    <tags>
	      <tag><lit-tag v="SN"/></tag>
	      <tag><clip pos="1" side="sl" part="gen"/></tag>
	      <tag><clip pos="1" side="tl" part="nbr"/></tag>
	    </tags>
	    <lu>   
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>





    <rule> <!-- REGLA: reset variables-->
      <pattern>
	<pattern-item n="sent"/>
      </pattern>
      <action>
	<let>
	  <var n="nombre"/>
	  <lit-tag v="sg"/>
	</let>
	<let>
	  <var n="genere"/>
	  <lit-tag v="m"/>
	</let>
        <let>
	  <var n="tipusverb"/>
	  <lit v=""/>
	</let>
	<choose>
	  <when>
	    <test>
	      <not>
		<or>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=";"/>
		  </equal>
		  <equal>
		    <clip pos="1" side="sl" part="lem"/>
		    <lit v=":"/>
		  </equal>
		</or>
	      </not>
	    </test>	      
	    <let>
	      <var n="EOS"/>
	      <lit v="true"/>
	    </let>
	  </when>
	</choose>
	<out>
	  <chunk name="punt">
	    <tags>
	      <tag><lit-tag v="sent"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
    </rule>
    
  <rule comment="REGLA: reset variables">
      <pattern>
	<pattern-item n="coma"/>
      </pattern>
      <action>
<!--	<let>
	  <var n="nombre"/>
	  <lit-tag v="sg"/>
	</let>
	<let>
	  <var n="genere"/>
	  <lit-tag v="m"/>
	</let> -->
        <let>
	  <var n="EOS"/>
	  <lit v="false"/>
	</let>
        <let>
	  <var n="tipusverb"/>
	  <lit v=""/>
	</let>
	<out>
	  <chunk name="coma">
	    <tags>
	      <tag><lit-tag v="cm"/></tag>
	    </tags>
	    <lu>
	      <clip pos="1" side="tl" part="whole"/>
	    </lu>
	  </chunk>
	</out>
      </action>
  </rule>


  </section-rules>
</transfer>
